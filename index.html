<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A minimal AutoML solution based on PyTorch."><meta name=author content=carefree0910><link rel="shortcut icon" href=assets/images/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-5.5.12"><title>carefree-learn</title><link rel=stylesheet href=assets/stylesheets/main.4dd2dd8d.min.css><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#carefree-learn class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=. title=carefree-learn class="md-header-nav__button md-logo" aria-label=carefree-learn> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> carefree-learn </span> <span class="md-header-nav__topic md-ellipsis"> Home </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/carefree0910/carefree-learn/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> carefree0910/carefree-learn </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=. title=carefree-learn class="md-nav__button md-logo" aria-label=carefree-learn> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> carefree-learn </label> <div class=md-nav__source> <a href=https://github.com/carefree0910/carefree-learn/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> carefree0910/carefree-learn </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Home <span class="md-nav__icon md-icon"></span> </label> <a href=. title=Home class="md-nav__link md-nav__link--active"> Home </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#why-carefree-learn class=md-nav__link> Why carefree-learn? </a> </li> <li class=md-nav__item> <a href=#installation class=md-nav__link> Installation </a> <nav class=md-nav aria-label=Installation> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pre-installing-pytorch class=md-nav__link> Pre-Installing PyTorch </a> </li> <li class=md-nav__item> <a href=#pip-installation class=md-nav__link> pip installation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#automl class=md-nav__link> AutoML </a> <nav class=md-nav aria-label=AutoML> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tl-dr class=md-nav__link> TL; DR </a> </li> <li class=md-nav__item> <a href=#explained class=md-nav__link> Explained </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> Examples </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> Quick Start </a> </li> <li class=md-nav__item> <a href=#distributed class=md-nav__link> Distributed </a> </li> <li class=md-nav__item> <a href=#hyper-parameter-optimization-hpo class=md-nav__link> Hyper Parameter Optimization (HPO) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#citation class=md-nav__link> Citation </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> License </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=introduction/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> User Guide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="User Guide" data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=user-guide/configurations/ title=Configurations class=md-nav__link> Configurations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=About data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=about/release-notes/ title="Release Notes" class=md-nav__link> Release Notes </a> </li> <li class=md-nav__item> <a href=about/license/ title=License class=md-nav__link> License </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#why-carefree-learn class=md-nav__link> Why carefree-learn? </a> </li> <li class=md-nav__item> <a href=#installation class=md-nav__link> Installation </a> <nav class=md-nav aria-label=Installation> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pre-installing-pytorch class=md-nav__link> Pre-Installing PyTorch </a> </li> <li class=md-nav__item> <a href=#pip-installation class=md-nav__link> pip installation </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#automl class=md-nav__link> AutoML </a> <nav class=md-nav aria-label=AutoML> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tl-dr class=md-nav__link> TL; DR </a> </li> <li class=md-nav__item> <a href=#explained class=md-nav__link> Explained </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> Examples </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> Quick Start </a> </li> <li class=md-nav__item> <a href=#distributed class=md-nav__link> Distributed </a> </li> <li class=md-nav__item> <a href=#hyper-parameter-optimization-hpo class=md-nav__link> Hyper Parameter Optimization (HPO) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#citation class=md-nav__link> Citation </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> License </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=carefree-learn>carefree-learn<a class=headerlink href=#carefree-learn title="Permanent link">&para;</a></h1> <p><code>carefree-learn</code> is a minimal Automatic Machine Learning (AutoML) solution for tabular datasets based on <a href=https://pytorch.org/ target=_blank>PyTorch</a>.</p> <h4 id=why-carefree-learn>Why carefree-learn?<a class=headerlink href=#why-carefree-learn title="Permanent link">&para;</a></h4> <p><code>carefree-learn</code></p> <ul> <li>Provides a <a href=https://scikit-learn.org/stable/ target=_blank>scikit-learn</a>-like interface with much more 'carefree' usages, including:<ul> <li>Automatically deals with data pre-processing.</li> <li>Automatically handles datasets saved in files (.txt, .csv).</li> <li>Supports <a href=introduction/#distributed-training>Distributed Training</a>, which means hyper-parameter tuning can be very efficient in <code>carefree-learn</code>.</li> </ul> </li> <li>Includes some brand new techniques which may boost vanilla Neural Network (NN) performances on tabular datasets, including:<ul> <li><a href=https://arxiv.org/pdf/1911.05443.pdf target=_blank><code>TreeDNN</code> with <code>Dynamic Soft Pruning</code></a>, which makes NN less sensitive to hyper-parameters. </li> <li><a href=https://arxiv.org/pdf/1911.05441.pdf target=_blank><code>Deep Distribution Regression (DDR)</code></a>, which is capable of modeling the entire conditional distribution with one single NN model.</li> </ul> </li> <li>Supports many convenient functionality in deep learning, including:<ul> <li>Early stopping.</li> <li>Model persistence.</li> <li>Learning rate schedulers.</li> <li>And more...</li> </ul> </li> <li>Full utilization of the WIP ecosystem <code>cf*</code>, such as:<ul> <li><a href=https://github.com/carefree0910/carefree-toolkit target=_blank><code>carefree-toolkit</code></a>: provides a lot of utility classes &amp; functions which are 'stand alone' and can be leveraged in your own projects.</li> <li><a href=https://github.com/carefree0910/carefree-data target=_blank><code>carefree-data</code></a>: a lightweight tool to read -&gt; convert -&gt; process <strong>ANY</strong> tabular datasets. It also utilizes <a href=https://cython.org/ target=_blank>cython</a> to accelerate critical procedures.</li> </ul> </li> </ul> <p>From the above, it comes out that <code>carefree-learn</code> could be treated as a minimal <strong>Auto</strong>matic <strong>M</strong>achine <strong>L</strong>earning (AutoML) solution for tabular datasets when it is fully utilized. However, this is not built on the sacrifice of flexibility. In fact, the functionality we've mentioned are all wrapped into individual modules in <code>carefree-learn</code> and allow users to customize them easily.</p> <h2 id=installation>Installation<a class=headerlink href=#installation title="Permanent link">&para;</a></h2> <p><code>carefree-learn</code> requires Python 3.6 or higher.</p> <h3 id=pre-installing-pytorch>Pre-Installing PyTorch<a class=headerlink href=#pre-installing-pytorch title="Permanent link">&para;</a></h3> <p>Please refer to <a href=https://pytorch.org/get-started/locally/ target=_blank>PyTorch</a>, and it is highly recommended to pre-install PyTorch with conda.</p> <h3 id=pip-installation>pip installation<a class=headerlink href=#pip-installation title="Permanent link">&para;</a></h3> <p>After installing PyTorch, installation of <code>carefree-learn</code> would be rather easy:</p> <ul> <li><em>Tips: if you pre-installed PyTorch with conda, remember to activate the corresponding environment!</em></li> </ul> <div class=highlight><pre><span></span><code>pip install carefree-learn
</code></pre></div> <p>or</p> <div class=highlight><pre><span></span><code>git clone https://github.com/carefree0910/carefree-learn.git
<span class=nb>cd</span> carefree-learn
pip install -e .
</code></pre></div> <h2 id=automl>AutoML<a class=headerlink href=#automl title="Permanent link">&para;</a></h2> <p><code>carefree-learn</code> provides <code>cflearn.Auto</code> API for out-of-the-box usages.</p> <h3 id=tl-dr>TL; DR<a class=headerlink href=#tl-dr title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>cflearn</span>

<span class=kn>from</span> <span class=nn>cfdata.tabular</span> <span class=kn>import</span> <span class=o>*</span>

<span class=c1># prepare iris dataset</span>
<span class=n>iris</span> <span class=o>=</span> <span class=n>TabularDataset</span><span class=o>.</span><span class=n>iris</span><span class=p>()</span>
<span class=n>iris</span> <span class=o>=</span> <span class=n>TabularData</span><span class=o>.</span><span class=n>from_dataset</span><span class=p>(</span><span class=n>iris</span><span class=p>)</span>
<span class=c1># split 10% of the data as validation data</span>
<span class=n>split</span> <span class=o>=</span> <span class=n>iris</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
<span class=n>train</span><span class=p>,</span> <span class=n>valid</span> <span class=o>=</span> <span class=n>split</span><span class=o>.</span><span class=n>remained</span><span class=p>,</span> <span class=n>split</span><span class=o>.</span><span class=n>split</span>
<span class=n>x_tr</span><span class=p>,</span> <span class=n>y_tr</span> <span class=o>=</span> <span class=n>train</span><span class=o>.</span><span class=n>processed</span><span class=o>.</span><span class=n>xy</span>
<span class=n>x_cv</span><span class=p>,</span> <span class=n>y_cv</span> <span class=o>=</span> <span class=n>valid</span><span class=o>.</span><span class=n>processed</span><span class=o>.</span><span class=n>xy</span>
<span class=n>data</span> <span class=o>=</span> <span class=n>x_tr</span><span class=p>,</span> <span class=n>y_tr</span><span class=p>,</span> <span class=n>x_cv</span><span class=p>,</span> <span class=n>y_cv</span>


<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
    <span class=c1># standard usage</span>
    <span class=n>fcnn</span> <span class=o>=</span> <span class=n>cflearn</span><span class=o>.</span><span class=n>make</span><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=o>*</span><span class=n>data</span><span class=p>)</span>

    <span class=c1># &#39;overfit&#39; validation set</span>
    <span class=n>auto</span> <span class=o>=</span> <span class=n>cflearn</span><span class=o>.</span><span class=n>Auto</span><span class=p>(</span><span class=n>TaskTypes</span><span class=o>.</span><span class=n>CLASSIFICATION</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=o>*</span><span class=n>data</span><span class=p>,</span> <span class=n>num_jobs</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>

    <span class=c1># estimate manually</span>
    <span class=n>predictions</span> <span class=o>=</span> <span class=n>auto</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x_cv</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;accuracy:&quot;</span><span class=p>,</span> <span class=p>(</span><span class=n>y_cv</span> <span class=o>==</span> <span class=n>predictions</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>

    <span class=c1># estimate with `cflearn`</span>
    <span class=n>cflearn</span><span class=o>.</span><span class=n>estimate</span><span class=p>(</span>
        <span class=n>x_cv</span><span class=p>,</span>
        <span class=n>y_cv</span><span class=p>,</span>
        <span class=n>pipelines</span><span class=o>=</span><span class=n>fcnn</span><span class=p>,</span>
        <span class=n>other_patterns</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;auto&quot;</span><span class=p>:</span> <span class=n>auto</span><span class=o>.</span><span class=n>pattern</span><span class=p>},</span>
    <span class=p>)</span>
</code></pre></div> <p>Then you will see something like this:</p> <div class=highlight><pre><span></span><code>================================================================================================================================
|        metrics         |                       acc                        |                       auc                        |
--------------------------------------------------------------------------------------------------------------------------------
|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |
--------------------------------------------------------------------------------------------------------------------------------
|          auto          | -- 1.000000 -- | -- 0.000000 -- | -- 1.000000 -- | -- 1.000000 -- | -- 0.000000 -- | -- 1.000000 -- |
--------------------------------------------------------------------------------------------------------------------------------
|          fcnn          |    0.933333    | -- 0.000000 -- |    0.933333    |    0.993333    | -- 0.000000 -- |    0.993333    |
================================================================================================================================
</code></pre></div> <h3 id=explained>Explained<a class=headerlink href=#explained title="Permanent link">&para;</a></h3> <p><code>cflearn.Auto.fit</code> will run through the following steps: 1. fetch pre-defined hyper-parameters search space from <code>OptunaPresetParams</code>. 2. leverage <code>optuna</code> with <code>cflearn.optuna_tune</code> to perform hyper-parameters optimization. 3. use searched hyper-parameters to train multiple neural networks and ensemble them (with <code>cflearn.ensemble</code> or <code>cflearn.Ensemble</code>). 4. record all these results to corresponding attributes.</p> <p>So after <code>cflearn.Auto.fit</code>, we can perform visualizations provided by <code>optuna</code> easily:</p> <div class=highlight><pre><span></span><code><span class=n>export_folder</span> <span class=o>=</span> <span class=s2>&quot;iris_vis&quot;</span>
<span class=n>auto</span><span class=o>.</span><span class=n>plot_param_importances</span><span class=p>(</span><span class=n>export_folder</span><span class=o>=</span><span class=n>export_folder</span><span class=p>)</span>
<span class=n>auto</span><span class=o>.</span><span class=n>plot_intermediate_values</span><span class=p>(</span><span class=n>export_folder</span><span class=o>=</span><span class=n>export_folder</span><span class=p>)</span>
</code></pre></div> <h2 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h2> <ul> <li><a href=https://github.com/carefree0910/carefree-learn/tree/dev/examples>Here</a> are some real life examples.</li> </ul> <h3 id=quick-start>Quick Start<a class=headerlink href=#quick-start title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>cflearn</span>
<span class=kn>from</span> <span class=nn>cfdata.tabular</span> <span class=kn>import</span> <span class=n>TabularDataset</span>

<span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>TabularDataset</span><span class=o>.</span><span class=n>iris</span><span class=p>()</span><span class=o>.</span><span class=n>xy</span>
<span class=n>m</span> <span class=o>=</span> <span class=n>cflearn</span><span class=o>.</span><span class=n>make</span><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<span class=c1># Make label predictions</span>
<span class=n>m</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=c1># Make probability predictions</span>
<span class=n>m</span><span class=o>.</span><span class=n>predict_prob</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=c1># Estimate performance</span>
<span class=n>cflearn</span><span class=o>.</span><span class=n>estimate</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>pipelines</span><span class=o>=</span><span class=n>m</span><span class=p>)</span>
</code></pre></div> <p>Then you will see something like this:</p> <div class=highlight><pre><span></span><code>================================================================================================================================
|        metrics         |                       acc                        |                       auc                        |
--------------------------------------------------------------------------------------------------------------------------------
|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |
--------------------------------------------------------------------------------------------------------------------------------
|          fcnn          |    0.946667    |    0.000000    |    0.946667    |    0.993200    |    0.000000    |    0.993200    |
================================================================================================================================
</code></pre></div> <p>It is also worth mentioning that <code>carefree-learn</code> models can be saved easily, into a zip file!</p> <p>For example, a <code>cflearn^_^fcnn.zip</code> file will be created with one line of code:</p> <div class=highlight><pre><span></span><code><span class=n>cflearn</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</code></pre></div> <p>Of course, loading <code>carefree-learn</code> models are easy too!</p> <div class=highlight><pre><span></span><code><span class=n>m</span> <span class=o>=</span> <span class=n>cflearn</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
<span class=c1># You will see exactly the same result as above!</span>
<span class=n>cflearn</span><span class=o>.</span><span class=n>estimate</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>pipelines</span><span class=o>=</span><span class=n>m</span><span class=p>)</span>
</code></pre></div> <p><code>carefree-learn</code> can also easily fit / predict / estimate directly on files (file-in, file-out). Suppose we have an 'xor.txt' file with following contents:</p> <div class=highlight><pre><span></span><code>0,0,0
0,1,1
1,0,1
1,1,0
</code></pre></div> <p>Then <code>carefree-learn</code> can be utilized with only one line of code:</p> <blockquote> <p><code>delim</code> refers to 'delimiter', and <code>skip_first</code> refers to whether skipping the first line or not.</p> <p>Please refer to <a href=https://github.com/carefree0910/carefree-data/blob/dev/README.md>carefree-data</a> if you're interested in more details.</p> </blockquote> <div class=highlight><pre><span></span><code><span class=n>m</span> <span class=o>=</span> <span class=n>cflearn</span><span class=o>.</span><span class=n>make</span><span class=p>(</span><span class=n>delim</span><span class=o>=</span><span class=s2>&quot;,&quot;</span><span class=p>,</span> <span class=n>skip_first</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=s2>&quot;xor.txt&quot;</span><span class=p>,</span> <span class=n>x_cv</span><span class=o>=</span><span class=s2>&quot;xor.txt&quot;</span><span class=p>)</span>
<span class=n>cflearn</span><span class=o>.</span><span class=n>estimate</span><span class=p>(</span><span class=s2>&quot;xor.txt&quot;</span><span class=p>,</span> <span class=n>pipelines</span><span class=o>=</span><span class=n>m</span><span class=p>)</span>
</code></pre></div> <p>After which you will see something like this:</p> <div class=highlight><pre><span></span><code>================================================================================================================================
|        metrics         |                       acc                        |                       auc                        |
--------------------------------------------------------------------------------------------------------------------------------
|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |
--------------------------------------------------------------------------------------------------------------------------------
|          fcnn          |    1.000000    |    0.000000    |    1.000000    |    1.000000    |    0.000000    |    1.000000    |
================================================================================================================================
</code></pre></div> <p>When we fit from files, we can predict on either files or lists:</p> <div class=highlight><pre><span></span><code><span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>predict</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]]))</span>   <span class=c1># [[0]]</span>
<span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>predict</span><span class=p>([[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]))</span>   <span class=c1># [[1]]</span>
<span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=s2>&quot;xor.txt&quot;</span><span class=p>))</span>  <span class=c1># [ [0] [1] [1] [0] ]</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>The maximum number of checkpoint files can be specified. See <strong><code>max_snapshot_num</code></strong> in <a href=user-guide/configurations/#high-level-api><code>cflearn.make</code></a> for more details.</p> </div> <h3 id=distributed>Distributed<a class=headerlink href=#distributed title="Permanent link">&para;</a></h3> <p>In <code>carefree-learn</code>, <strong>Distributed Training</strong> doesn't mean training your model on multiple GPUs or multiple machines, because <code>carefree-learn</code> focuses on tabular datasets (or, structured datasets) which are often not as large as unstructured datasets. Instead, <strong>Distributed Training</strong> in <code>carefree-learn</code> means <strong>training multiple models</strong> at the same time. This is important because:</p> <ul> <li>Deep Learning models suffer from randomness, so we need to train multiple models with the same algorithm and calculate the mean / std of the performances to estimate the algorithm's capacity and stability.</li> <li>Ensemble these models (which are trained with the same algorithm) can boost the algorithm's performance without making any changes to the algorithm itself.</li> <li>Parameter searching will be easier &amp; faster.</li> </ul> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>cflearn</span>
<span class=kn>from</span> <span class=nn>cfdata.tabular</span> <span class=kn>import</span> <span class=n>TabularDataset</span>

<span class=c1># It is necessary to wrap codes under &#39;__main__&#39; on WINDOWS platform when running distributed codes</span>
<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
    <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>TabularDataset</span><span class=o>.</span><span class=n>iris</span><span class=p>()</span><span class=o>.</span><span class=n>xy</span>
    <span class=c1># Notice that 3 fcnn were trained simultaneously with this line of code</span>
    <span class=n>results</span> <span class=o>=</span> <span class=n>cflearn</span><span class=o>.</span><span class=n>repeat_with</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>num_repeat</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>num_jobs</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
    <span class=n>patterns</span> <span class=o>=</span> <span class=n>results</span><span class=o>.</span><span class=n>patterns</span><span class=p>[</span><span class=s2>&quot;fcnn&quot;</span><span class=p>]</span>
    <span class=c1># And it is fairly straight forward to apply stacking ensemble</span>
    <span class=n>ensemble</span> <span class=o>=</span> <span class=n>cflearn</span><span class=o>.</span><span class=n>ensemble</span><span class=p>(</span><span class=n>patterns</span><span class=p>)</span>
    <span class=n>patterns_dict</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;fcnn_3&quot;</span><span class=p>:</span> <span class=n>patterns</span><span class=p>,</span> <span class=s2>&quot;fcnn_3_ensemble&quot;</span><span class=p>:</span> <span class=n>ensemble</span><span class=p>}</span>
    <span class=n>cflearn</span><span class=o>.</span><span class=n>estimate</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>metrics</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;acc&quot;</span><span class=p>,</span> <span class=s2>&quot;auc&quot;</span><span class=p>],</span> <span class=n>other_patterns</span><span class=o>=</span><span class=n>patterns_dict</span><span class=p>)</span>
</code></pre></div> <p>Then you will see something like this:</p> <div class=highlight><pre><span></span><code>================================================================================================================================
|        metrics         |                       acc                        |                       auc                        |
--------------------------------------------------------------------------------------------------------------------------------
|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |
--------------------------------------------------------------------------------------------------------------------------------
|         fcnn_3         |    0.937778    |    0.017498    |    0.920280    | -- 0.993911 -- |    0.000274    |    0.993637    |
--------------------------------------------------------------------------------------------------------------------------------
|    fcnn_3_ensemble     | -- 0.953333 -- | -- 0.000000 -- | -- 0.953333 -- |    0.993867    | -- 0.000000 -- | -- 0.993867 -- |
================================================================================================================================
</code></pre></div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>You might notice that the best results of each column is 'highlighted' with a pair of '--'.</p> </div> <h3 id=hyper-parameter-optimization-hpo>Hyper Parameter Optimization (HPO)<a class=headerlink href=#hyper-parameter-optimization-hpo title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>cflearn</span>
<span class=kn>from</span> <span class=nn>cfdata.tabular</span> <span class=kn>import</span> <span class=o>*</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
    <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>TabularDataset</span><span class=o>.</span><span class=n>iris</span><span class=p>()</span><span class=o>.</span><span class=n>xy</span>
    <span class=c1># Bayesian Optimization (BO) will be used as default</span>
    <span class=n>hpo</span> <span class=o>=</span> <span class=n>cflearn</span><span class=o>.</span><span class=n>tune_with</span><span class=p>(</span>
        <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span>
        <span class=n>task_type</span><span class=o>=</span><span class=n>TaskTypes</span><span class=o>.</span><span class=n>CLASSIFICATION</span><span class=p>,</span>
        <span class=n>num_repeat</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>num_parallel</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>num_search</span><span class=o>=</span><span class=mi>10</span>
    <span class=p>)</span>
    <span class=c1># We can further train our model with the best hyper-parameters we&#39;ve obtained:</span>
    <span class=n>m</span> <span class=o>=</span> <span class=n>cflearn</span><span class=o>.</span><span class=n>make</span><span class=p>(</span><span class=o>**</span><span class=n>hpo</span><span class=o>.</span><span class=n>best_param</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
    <span class=n>cflearn</span><span class=o>.</span><span class=n>estimate</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>pipelines</span><span class=o>=</span><span class=n>m</span><span class=p>)</span>
</code></pre></div> <p>Then you will see something like this:</p> <div class=highlight><pre><span></span><code>~~~  [ info ] Results
================================================================================================================================
|        metrics         |                       acc                        |                       auc                        |
--------------------------------------------------------------------------------------------------------------------------------
|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |
--------------------------------------------------------------------------------------------------------------------------------
|        0659e09f        |    0.943333    |    0.016667    |    0.926667    |    0.995500    |    0.001967    |    0.993533    |
--------------------------------------------------------------------------------------------------------------------------------
|        08a0a030        |    0.796667    |    0.130000    |    0.666667    |    0.969333    |    0.012000    |    0.957333    |
--------------------------------------------------------------------------------------------------------------------------------
|        1962285c        |    0.950000    |    0.003333    |    0.946667    |    0.997467    |    0.000533    |    0.996933    |
--------------------------------------------------------------------------------------------------------------------------------
|        1eb7f2a0        |    0.933333    |    0.020000    |    0.913333    |    0.994833    |    0.003033    |    0.991800    |
--------------------------------------------------------------------------------------------------------------------------------
|        4ed5bb3b        |    0.973333    |    0.013333    |    0.960000    |    0.998733    |    0.000467    |    0.998267    |
--------------------------------------------------------------------------------------------------------------------------------
|        5a652f3c        |    0.953333    | -- 0.000000 -- |    0.953333    |    0.997400    |    0.000133    |    0.997267    |
--------------------------------------------------------------------------------------------------------------------------------
|        82c35e77        |    0.940000    |    0.020000    |    0.920000    |    0.995467    |    0.002133    |    0.993333    |
--------------------------------------------------------------------------------------------------------------------------------
|        a9ef52d0        | -- 0.986667 -- |    0.006667    | -- 0.980000 -- | -- 0.999200 -- | -- 0.000000 -- | -- 0.999200 -- |
--------------------------------------------------------------------------------------------------------------------------------
|        ba2e179a        |    0.946667    |    0.026667    |    0.920000    |    0.995633    |    0.001900    |    0.993733    |
--------------------------------------------------------------------------------------------------------------------------------
|        ec8c0837        |    0.973333    | -- 0.000000 -- |    0.973333    |    0.998867    |    0.000067    |    0.998800    |
================================================================================================================================

~~~  [ info ] Best Parameters
----------------------------------------------------------------------------------------------------
acc  (a9ef52d0) (0.986667 ± 0.006667)
----------------------------------------------------------------------------------------------------
{&#39;optimizer&#39;: &#39;rmsprop&#39;, &#39;optimizer_config&#39;: {&#39;lr&#39;: 0.005810863965757382}}
----------------------------------------------------------------------------------------------------
auc  (a9ef52d0) (0.999200 ± 0.000000)
----------------------------------------------------------------------------------------------------
{&#39;optimizer&#39;: &#39;rmsprop&#39;, &#39;optimizer_config&#39;: {&#39;lr&#39;: 0.005810863965757382}}
----------------------------------------------------------------------------------------------------
best (a9ef52d0)
----------------------------------------------------------------------------------------------------
{&#39;optimizer&#39;: &#39;rmsprop&#39;, &#39;optimizer_config&#39;: {&#39;lr&#39;: 0.005810863965757382}}
----------------------------------------------------------------------------------------------------

~~  [ info ] Results
================================================================================================================================
|        metrics         |                       acc                        |                       auc                        |
--------------------------------------------------------------------------------------------------------------------------------
|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |
--------------------------------------------------------------------------------------------------------------------------------
|          fcnn          |    0.980000    |    0.000000    |    0.980000    |    0.998867    |    0.000000    |    0.998867    |
================================================================================================================================
</code></pre></div> <p>You might notice that:</p> <ul> <li>The final results obtained by <strong>HPO</strong> is even better than the stacking ensemble results mentioned above.</li> <li>We search for <code>optimizer</code> and <code>lr</code> as default. In fact, we can manually passed <code>params</code> into <code>cflearn.tune_with</code>. If not, then <code>carefree-learn</code> will execute following codes: <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>cftool.ml.param_utils</span> <span class=kn>import</span> <span class=o>*</span>

<span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s2>&quot;optimizer&quot;</span><span class=p>:</span> <span class=n>String</span><span class=p>(</span><span class=n>Choice</span><span class=p>(</span><span class=n>values</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;sgd&quot;</span><span class=p>,</span> <span class=s2>&quot;rmsprop&quot;</span><span class=p>,</span> <span class=s2>&quot;adam&quot;</span><span class=p>])),</span>
    <span class=s2>&quot;optimizer_config&quot;</span><span class=p>:</span> <span class=p>{</span>
        <span class=s2>&quot;lr&quot;</span><span class=p>:</span> <span class=n>Float</span><span class=p>(</span><span class=n>Exponential</span><span class=p>(</span><span class=mf>1e-5</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>))</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div></li> </ul> <div class="admonition info"> <p class=admonition-title>Info</p> <p>It is also worth mentioning that we can pass file datasets into <code>cflearn.tune_with</code> as well. See <code>tests/usages/test_basic.py</code> for more details.</p> </div> <h2 id=citation>Citation<a class=headerlink href=#citation title="Permanent link">&para;</a></h2> <p>If you use <code>carefree-learn</code> in your research, we would greatly appreciate if you cite this library using this Bibtex:</p> <div class=highlight><pre><span></span><code>@misc{carefree-learn,
  year={2020},
  author={Yujian He},
  title={carefree-learn, a minimal Automatic Machine Learning (AutoML) solution for tabular datasets based on PyTorch},
  howpublished={\url{https://https://github.com/carefree0910/carefree-learn/}},
}
</code></pre></div> <h2 id=license>License<a class=headerlink href=#license title="Permanent link">&para;</a></h2> <p><code>carefree-learn</code> is MIT licensed, as found in the <a href=about/license/ ><code>LICENSE</code></a> file.</p> <hr> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=introduction/ title=Introduction class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Introduction </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2019 - 2020 Yujian He </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/carefree0910 target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=assets/javascripts/vendor.3636a4ec.min.js></script> <script src=assets/javascripts/bundle.e9fe3281.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: ".",
          features: [],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>