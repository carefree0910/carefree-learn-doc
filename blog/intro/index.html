<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<link rel="search" type="application/opensearchdescription+xml" title="carefree-learn" href="/carefree-learn-doc/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><title data-react-helmet="true">Tabular Datasets ‚ù§Ô∏è¬†PyTorch | carefree-learn</title><meta data-react-helmet="true" property="og:title" content="Tabular Datasets ‚ù§Ô∏è¬†PyTorch | carefree-learn"><meta data-react-helmet="true" name="description" content="carefree-learn is a minimal Automatic Machine Learning (AutoML) solution for tabular datasets based on PyTorch. It is the 2nd-place winner in the Global PyTorch Summer Hackathon 2020. The library is documented and you can try it out after installing it."><meta data-react-helmet="true" property="og:description" content="carefree-learn is a minimal Automatic Machine Learning (AutoML) solution for tabular datasets based on PyTorch. It is the 2nd-place winner in the Global PyTorch Summer Hackathon 2020. The library is documented and you can try it out after installing it."><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:image" content="https://carefree0910.me/carefree-learn-doc/../static/img/title.jpg"><meta data-react-helmet="true" property="twitter:image" content="https://carefree0910.me/carefree-learn-doc/../static/img/title.jpg"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Tabular Datasets ‚ù§Ô∏è¬†PyTorch"><link data-react-helmet="true" rel="shortcut icon" href="/carefree-learn-doc/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/carefree-learn-doc/styles.269988ea.css">
<link rel="preload" href="/carefree-learn-doc/styles.a6aa9387.js" as="script">
<link rel="preload" href="/carefree-learn-doc/runtime~main.23e4d0f1.js" as="script">
<link rel="preload" href="/carefree-learn-doc/main.776c50ea.js" as="script">
<link rel="preload" href="/carefree-learn-doc/1.82f460cf.js" as="script">
<link rel="preload" href="/carefree-learn-doc/2.b1a07c36.js" as="script">
<link rel="preload" href="/carefree-learn-doc/ccc49370.1edb6af6.js" as="script">
<link rel="preload" href="/carefree-learn-doc/a5e08a40.07d56649.js" as="script">
<link rel="preload" href="/carefree-learn-doc/1d039b86.bef88d6e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/carefree-learn-doc/"><strong class="navbar__title">carefree-learn</strong></a><a class="navbar__item navbar__link" href="/carefree-learn-doc/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/carefree-learn-doc/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">‚åò</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/carefree-learn-doc/"><strong class="navbar__title">carefree-learn</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/carefree-learn-doc/docs/">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/carefree-learn-doc/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_3I7I thin-scrollbar"><h3 class="sidebarItemTitle_2Dv3">Recent posts</h3><ul class="sidebarItemList_1RlG"><li class="sidebarItem_Hxgp"><a aria-current="page" class="sidebarItemLink_3ppv sidebarItemLinkActive_3XUi" href="/carefree-learn-doc/blog/intro">Tabular Datasets ‚ù§Ô∏è¬†PyTorch</a></li></ul></div></div><main class="col col--8"><article><header><h1 class="margin-bottom--sm blogPostTitle_1mse">Tabular Datasets ‚ù§Ô∏è¬†PyTorch</h1><div class="margin-vert--md"><time datetime="2020-11-23T00:00:00.000Z" class="blogPostDate_3bQP">November 23, 2020  ¬∑ 14 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/carefree0910" target="_blank" rel="noreferrer noopener"><img src="https://avatars2.githubusercontent.com/u/15677328?s=400&amp;u=4f6885246f1b9bb7b22312889859a824c9b05629&amp;v=4" alt="carefree0910"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/carefree0910" target="_blank" rel="noreferrer noopener">carefree0910</a></h4><small class="avatar__subtitle">Individual Developer</small></div></div></header><section class="markdown"><p><code>carefree-learn</code> is a minimal Automatic Machine Learning (AutoML) solution for tabular datasets based on PyTorch. It is the 2nd-place winner in the Global PyTorch Summer Hackathon 2020. The library is <a href="https://carefree0910.me/carefree-learn-doc/docs" target="_blank" rel="noopener noreferrer">documented</a> and you can try it out after <a href="https://carefree0910.me/carefree-learn-doc/docs/getting-started/installation" target="_blank" rel="noopener noreferrer">installing it</a>.</p><ul><li><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://www.youtube.com/watch?v=hMzLmwmdQ_k&amp;t=10s" target="_blank" rel="noopener noreferrer">YouTube</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="why-carefree-learn"></a>Why carefree-learn?<a aria-hidden="true" class="hash-link" href="#why-carefree-learn" title="Direct link to heading">#</a></h2><p>If you are familiar with machine learning, you may already heard about scikit-learn and some other automl frameworks. The motivation behind creating carefree-learn was two fold:</p><ul><li>Leverage <a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">PyTorch</a> in the field of machine learning.</li><li>Provide a truly CAREFREE experience for both users and developers.</li></ul><p>By saying carefree we mean that both using and developing carefree-learn could be finished in one line of code:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cflearn</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># train a neural network on x &amp; y</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># defining your new model and train with it</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">register_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;awesome_model&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipes</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PipeInfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;dndf&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;awesome_model&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Please refer to <a href="https://carefree0910.me/carefree-learn-doc/docs/getting-started/quick-start" target="_blank" rel="noopener noreferrer">Quick Start</a> and <a href="https://carefree0910.me/carefree-learn-doc/docs/developer-guides/customization" target="_blank" rel="noopener noreferrer">Build Your Own Models</a> for more details.</p></div></div><p>You may argue that other libraries, like scikit-learn, also support building models in one line of code. But think about the messy stuffs (such as reading data from files, exploring data, performing data pre-processing, etc.) we need to do before we actually use these libraries, and contributing algorithms to these libraries is often much harder than writing your own ones. In carefree-learn, we&#x27;ve tried hard to ease these two procedures for you.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="carefree-using"></a>Carefree using<a aria-hidden="true" class="hash-link" href="#carefree-using" title="Direct link to heading">#</a></h3><p>As mentioned, other libraries (e.g. scikit-learn) can often only support <code>numpy</code> arrays or <code>DataFrame</code> as input, and have pretty much constraints (e.g. cannot contain <code>nan</code> values). In carefree-learn, however, we&#x27;ve tried hard to help you deal with almost <strong>ANY</strong> kind of tabular datasets, no matter how dirty and messy it is. This means carefree-learn actually provides an end-to-end pipeline on tabular datasets, including <strong>AUTOMATICALLY</strong> deal with:</p><ul><li>Detection of redundant feature columns which can be excluded (all SAME, all DIFFERENT, etc).</li><li>Detection of feature columns types (whether a feature column is string column / numerical column / categorical column).</li><li>Encoding of string columns and categorical columns (Embedding or One Hot Encoding).</li><li>Pre-processing of numerical columns (Normalize, Min Max, etc.).</li><li>Imputation of missing values.</li><li>And much more‚Ä¶</li></ul><p>Therefore, carefree-learn is possible to procss files directly (file-in, file-out):</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cflearn</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># train a neural network on train.csv</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;train.csv&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># make predictions on test.csv</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">predictions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;test.csv&quot;</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>This is mainly handled by <a href="https://github.com/carefree0910/carefree-data" target="_blank" rel="noopener noreferrer">carefree-data</a>, part of the <code>cf*</code> ecosystem</p></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Please refer to <a href="https://carefree0910.me/carefree-learn-doc/docs/getting-started/quick-start" target="_blank" rel="noopener noreferrer">Quick Start</a> for more details.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="carefree-developing"></a>Carefree developing<a aria-hidden="true" class="hash-link" href="#carefree-developing" title="Direct link to heading">#</a></h3><p>Thanks to the great modularization provided by <a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">PyTorch</a>, <code>carefree-learn</code> was able to design its (tabular datasets oriented) pipeline in a user-friendly as well as a developer-friendly way.</p><p>The basic component in <code>carefree-learn</code> is called a <a href="https://carefree0910.me/carefree-learn-doc/docs/design-principles#pipe" target="_blank" rel="noopener noreferrer"><code>pipe</code></a>, which corresponds to one of those <em>branches</em> which takes in all / part of the inputs, apply some <a href="https://carefree0910.me/carefree-learn-doc/docs/design-principles#transform" target="_blank" rel="noopener noreferrer"><code>transform</code></a>, extract some features with <a href="https://carefree0910.me/carefree-learn-doc/docs/design-principles#extractor" target="_blank" rel="noopener noreferrer"><code>extractor</code></a>, and then feed the final network (<a href="https://carefree0910.me/carefree-learn-doc/docs/design-principles#head" target="_blank" rel="noopener noreferrer"><code>head</code></a>) with these features. Here&#x27;s an example:</p><p><img alt="Pipe" src="/carefree-learn-doc/assets/images/pipe-6659ec015a73ac027c5b2a8bdb83360e.png"></p><p>Since most of the deep learning models (neural networks) used in tabular datasets could be represented with <code>pipe</code>, developers can therefore focus on implementing one of its components (namely <code>extractor</code> and <code>head</code>), instead of having to care about the whole pipeline.</p><p>We&#x27;ve provided a detailed documention on <a href="https://carefree0910.me/carefree-learn-doc/docs/developer-guides/customization" target="_blank" rel="noopener noreferrer">how to build your own models</a>, as well as an interesting <a href="https://carefree0910.me/carefree-learn-doc/docs/examples/operations" target="_blank" rel="noopener noreferrer">example</a> to guide you step by step. Please feel free to check them out and enjoy yourself!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="why-pytorch"></a>Why PyTorch?<a aria-hidden="true" class="hash-link" href="#why-pytorch" title="Direct link to heading">#</a></h2><p>The reason why I choosed <a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">PyTorch</a> has already been mentioned above‚Ää-‚Ääit is perfectly modularized and customizable. Another reason is that although deep learning outshines in CV and NLP fields, it is not as popular when it comes to the tabular datasets. We think the main reason is that tabular datasets require so many messy steps before we could actually jump into the algorithm part, and there has not existed a modularized framework to organize these stuffs. That&#x27;s why we tried our best to handle all of these for you and hope that it could help you focus on developing the core algorithms. And among the deep learning frameworks, <a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">PyTorch</a> was truly the most elegant one and we were deeply attracted by its simplicity and power. Since there lacks a satisfying &#x27;carefree&#x27; solution for tabular datasets,  we decided to take advantage of our knowledges and build one ourselves. So here comes the carefree-learn, which aims to provide out of the box tools to train and develop neural networks on tabular datasets with <a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">PyTorch</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="getting-started-with-iris"></a>Getting Started with Iris<a aria-hidden="true" class="hash-link" href="#getting-started-with-iris" title="Direct link to heading">#</a></h2><p>We&#x27;ve provided an <a href="https://carefree0910.me/carefree-learn-doc/docs/getting-started/installation" target="_blank" rel="noopener noreferrer">Installation Guide</a> as well as some real life <a href="https://carefree0910.me/carefree-learn-doc/docs/examples/iris" target="_blank" rel="noopener noreferrer">Examples</a> to walk you through the basic / advanced usages of carefree-learn. We&#x27;ve also provided a <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/production" target="_blank" rel="noopener noreferrer">Production Guide</a> to show how could we pack the whole pipeline in carefree-learn efficiently into a zip file. In this section, we‚Äôll use the famous <a href="https://archive.ics.uci.edu/ml/datasets/iris" target="_blank" rel="noopener noreferrer">Iris dataset</a> to demonstrate the power of carefree-learn.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>We‚Äôve provided the complete source code <a href="https://github.com/carefree0910/carefree-learn/blob/dev/examples/iris/iris.py" target="_blank" rel="noopener noreferrer">here</a> as well as a jupyter notebook <a href="https://github.com/carefree0910/carefree-learn/blob/dev/examples/iris/iris.ipynb" target="_blank" rel="noopener noreferrer">here</a>.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="inspect-the-iris-dataset"></a>Inspect the Iris Dataset<a aria-hidden="true" class="hash-link" href="#inspect-the-iris-dataset" title="Direct link to heading">#</a></h3><p>Here are some of the information provided by the official website:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">This is perhaps the best known database to be found in the pattern recognition literature.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">The data set contains 3 classes of 50 instances each, where each class refers to a type of iris plant.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Predicted attribute: class of iris plant.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>And here‚Äôs the pandas-view of the raw data (we didn‚Äôt use pandas in our code, but it is convenient to visualize some data with it though ü§£):</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">      f0   f1   f2   f3           label</span></div><div class="token-line" style="color:#393A34"><span class="token plain">0    5.1  3.5  1.4  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">1    4.9  3.0  1.4  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">2    4.7  3.2  1.3  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">3    4.6  3.1  1.5  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">4    5.0  3.6  1.4  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">..   ...  ...  ...  ...             ...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">145  6.7  3.0  5.2  2.3  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain">146  6.3  2.5  5.0  1.9  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain">147  6.5  3.0  5.2  2.0  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain">148  6.2  3.4  5.4  2.3  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain">149  5.9  3.0  5.1  1.8  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">[150 rows x 5 columns]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You can download the raw data (<strong>iris.data</strong>) with <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data" target="_blank" rel="noopener noreferrer">this link</a>.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="basic-usages"></a>Basic Usages<a aria-hidden="true" class="hash-link" href="#basic-usages" title="Direct link to heading">#</a></h3><p>Traditionally, we need to process the raw data before we feed them into our machine learning models (e.g. encode the label column, which is a string column, into an ordinal column). In carefree-learn, however, we can train neural networks directly on files without worrying about the rest:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cflearn</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>What‚Äôs going under the hood is that carefree-learn will try to parse the <code>iris.data</code> automatically (with the help of <a href="https://github.com/carefree0910/carefree-data" target="_blank" rel="noopener noreferrer">carefree-data</a>), split the data into training set and validation set, with which we‚Äôll train a fully connected neural network (<code>fcnn</code>).</p><p>We can further inspect the processed data if we want to know how carefree-learn actually parsed the input data:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># print out the first elements in the dataset</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tr_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">raw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tr_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">raw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tr_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tr_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">[&#x27;4.6&#x27;, &#x27;3.6&#x27;, &#x27;1.0&#x27;, &#x27;0.2&#x27;]</span></div><div class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">[&#x27;Iris-setosa&#x27;]</span></div><div class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">[-1.5065205  1.2634597 -1.5687355 -1.3129768]</span></div><div class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">[0]</span></div><div class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>It shows that the raw data is carefully normalized into numerical data that neural networks can accept. You may also notice that the first elements are not identical with the first line of the raw data, this is caused by the auto-shuffle mechanism introduced in <a href="https://github.com/carefree0910/carefree-data" target="_blank" rel="noopener noreferrer">carefree-data</a>).</p><p>What‚Äôs more, by saying <em>normalized</em>, it means that the input features will be automatically normalized to <code>mean=0.0</code> and <code>std=1.0</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">tr_x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tr_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span></div><div class="token-line" style="color:#393A34"><span class="token plain">cv_x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cv_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span></div><div class="token-line" style="color:#393A34"><span class="token plain">stacked </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">tr_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv_x</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stacked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stacked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">std</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">[ 3.1739475e-08 -3.7471455e-07 -1.9907951e-07 -8.0267590e-08]</span></div><div class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">[0.99999976 0.9999997  1.0000002  0.9999999 ]</span></div><div class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>This means we first normalized the data before we actually split it into train &amp; validation set.</p></div></div><p>After training on files, carefree-learn can predict &amp; evaluate on files directly as well. We‚Äôll handle the data parsing and normalization for you automatically:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># `contains_labels` is set to True because `iris.data` itself contains labels</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">predictions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> contains_labels</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># evaluations could be achieved easily with cflearn.evaluate</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipelines</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        metrics         |                       acc                        |                       auc                        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          fcnn          |    0.926667    |    0.000000    |    0.926667    |    0.994800    |    0.000000    |    0.994800    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="benchmarking"></a>Benchmarking<a aria-hidden="true" class="hash-link" href="#benchmarking" title="Direct link to heading">#</a></h3><p>As we know, neural networks are trained with stochastic gradient descent (and its variants), which will introduce some randomness to the final result, even if we are training on the same dataset. In this case, we need to repeat the same task several times in order to obtain the bias &amp; variance of our neural networks. Fortunately, carefree-learn introduced <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/distributed#repeat_with" target="_blank" rel="noopener noreferrer"><code>repeat_with</code></a> API, which can achieve this goal easily with only a few lines of code:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># With num_repeat=3 specified, we‚Äôll train 3 models on iris.data</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">repeat_with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_repeat</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipelines</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipelines</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        metrics         |                       acc                        |                       auc                        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          fcnn          |    0.902222    |    0.019116    |    0.883106    |    0.985778    |    0.004722    |    0.981055    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>We can also compare the performances across different models:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># With models=[&quot;linear&quot;, &quot;fcnn&quot;], we&#x27;ll train both linear models and fcnn models.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">models </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;linear&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fcnn&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">repeat_with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> models</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">models</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_repeat</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipelines</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipelines</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        metrics         |                       acc                        |                       auc                        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          fcnn          | -- 0.915556 -- | -- 0.027933 -- | -- 0.887623 -- | -- 0.985467 -- | -- 0.004121 -- | -- 0.981345 -- |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|         linear         |    0.620000    |    0.176970    |    0.443030    |    0.733778    |    0.148427    |    0.585351    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>It is worth mentioning that carefree-learn supports <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/distributed/#distributed-training" target="_blank" rel="noopener noreferrer">distributed training</a>, which means when we need to perform large scale benchmarking (e.g. train 100 models), we could accelerate the process through multiprocessing:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># With num_jobs=2, we will launch 2 processes to run the tasks in a distributed way.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">repeat_with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_repeat</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_jobs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>In carefree-learn, distributed training doesn&#x27;t mean training your model on multiple GPUs or multiple machines. Instead, distributed training in carefree-learn means training multiple models at the same time. Please refer to our <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/distributed/#distributed-training" target="_blank" rel="noopener noreferrer">documentation</a> for more details.</p></div></div><p>On iris dataset, however, launching distributed training will actually hurt the speed because iris dataset only contains 150 samples, so the relative overhead brought by distributed training will be too large. Please refer the <strong>CAUTION</strong> section of our <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/distributed/#benchmarking" target="_blank" rel="noopener noreferrer">documentation</a> for more details.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="advanced-benchmarking"></a>Advanced Benchmarking<a aria-hidden="true" class="hash-link" href="#advanced-benchmarking" title="Direct link to heading">#</a></h3><p>But this is not enough, because we want to know whether other models (e.g. scikit-learn models) could achieve a better performance than carefree-learn models. In this case, we can perform an advanced benchmarking with the <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/distributed/#experiment" target="_blank" rel="noopener noreferrer">Experiment</a> helper class.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">experiment </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Experiment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">tr_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tr_y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tr_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">cv_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv_y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cv_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">data_folder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dump_data_bundle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tr_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tr_y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv_y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add carefree-learn tasks</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> model </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;linear&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fcnn&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_folder</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data_folder</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add scikit-learn tasks</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">run_command </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;python run_sklearn.py&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">common_kwargs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;run_command&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> run_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;data_folder&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data_folder</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;decision_tree&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">common_kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;random_forest&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">common_kwargs</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Notice that we specified run_command=&quot;python run_sklearn.py&quot; for scikit-learn tasks, which means <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/distributed/#experiment" target="_blank" rel="noopener noreferrer">Experiment</a> will try to execute this command in the current working directory for training scikit-learn models. The good news is that we do not need to speciy any command line arguments, because <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/distributed/#experiment" target="_blank" rel="noopener noreferrer">Experiment</a> will handle those for us.</p><p>Here is basically what a <code>run_sklearn.py</code> should look like (<a href="http://localhost:8888/files/run_sklearn.py" target="_blank" rel="noopener noreferrer">source code</a>):</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pickle</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tree </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> DecisionTreeClassifier</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ensemble </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> RandomForestClassifier</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dist</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">runs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_info</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    info </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    kwargs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kwargs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># data</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    data_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_list</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data_list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># model</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kwargs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;model&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> model </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;decision_tree&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        base </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> DecisionTreeClassifier</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> model </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;random_forest&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        base </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> RandomForestClassifier</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">raise</span><span class="token plain"> NotImplementedError</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    sk_model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># train &amp; save</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    sk_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ravel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workplace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sk_model.pkl&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;wb&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        pickle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dump</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sk_model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>With <code>run_sklearn.py</code> defined, we could run those tasks with one line of code:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run_tasks</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>After finished running, we should be able to see the following file structure in the current working directory:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">|--- __experiment__</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- __data__</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- x.npy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- y.npy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- x_cv.npy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- y_cv.npy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- fcnn/0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- _logs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- __meta__.json</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- cflearn^_^fcnn^_^0000.zip</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- linear/0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- ...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- decision_tree/0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- __meta__.json</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- sk_model.pkl</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- random_forest/0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- ...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>As we expected, carefree-learn models are saved into zip files, while scikit-learn models are saved into <code>sk_model.pkl</code> files. Since these models are not yet loaded, we should manually load them into our environment:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">pipelines </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">sk_patterns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> workplace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workplace_key </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">zip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workplaces</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workplace_keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workplace_key</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> model </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;decision_tree&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;random_forest&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        pipelines</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">task_loader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workplace</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        model_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workplace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sk_model.pkl&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rb&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pickle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># In `carefree-learn`, we treat labels as column vectors.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># So we need to reshape the outputs from the scikit-learn models.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_predict </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sk_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_predict_prob </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sk_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict_proba</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_pattern </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModelPattern</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                predict_method</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sk_predict</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                predict_prob_method</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sk_predict_prob</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_patterns</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sk_pattern</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>After which we can finally perform benchmarking on these models:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cv_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv_y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipelines</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">pipelines</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> other_patterns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sk_patterns</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">~~~  [ info ] Results</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        metrics         |                       acc                        |                       auc                        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|     decision_tree      | -- 0.960000 -- | -- 0.000000 -- | -- 0.960000 -- | -- 0.998667 -- | -- 0.000000 -- | -- 0.998667 -- |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          fcnn          | -- 0.960000 -- | -- 0.000000 -- | -- 0.960000 -- |    0.994133    | -- 0.000000 -- |    0.994133    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|         linear         |    0.466667    | -- 0.000000 -- |    0.466667    |    0.725600    | -- 0.000000 -- |    0.725600    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|     random_forest      | -- 0.960000 -- | -- 0.000000 -- | -- 0.960000 -- | -- 0.998667 -- | -- 0.000000 -- | -- 0.998667 -- |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Seems that scikit-learn models are better than carefree-learn models! This is not surprising because neural networks often require more data than traditional machine learning algorithms. However, we can boost carefree-learn models with AutoML, as shown in the next section.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="automl-on-iris"></a>AutoML on Iris<a aria-hidden="true" class="hash-link" href="#automl-on-iris" title="Direct link to heading">#</a></h3><p>As mentioned in the introduction, carefree-learn is actually a minimal Automatic Machine Learning (AutoML) solution for tabular datasets. Up till now we haven&#x27;t mentioned any AutoML stuffs yet, so in this section we&#x27;ll illustrate how to perform AutoML on Iris dataset, as well as how to pack the AutoML results into production.</p><p>Since carefree-learn has provided the <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/auto-ml/" target="_blank" rel="noopener noreferrer">cflearn.Auto</a> API for out-of-the-box usages, AutoML in carefree-learn could be achieved in two lines of code:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">auto </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Auto</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;clf&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> models</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;fcnn&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">auto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tr_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tr_y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv_y</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>We can make predictions directly with <code>auto.predict</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">predictions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> auto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cv_x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;accuracy:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">predictions </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> cv_y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># ~0.985</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>And of course, we can compare it with other models:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">all_patterns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sk_patterns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">all_patterns</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;auto&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> auto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pattern</span></div><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cv_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv_y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipelines</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">pipelines</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> other_patterns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">all_patterns</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        metrics         |                       acc                        |                       auc                        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          auto          | -- 0.986667 -- | -- 0.000000 -- | -- 0.986667 -- | -- 0.998933 -- | -- 0.000000 -- | -- 0.998933 -- |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|     decision_tree      |    0.960000    | -- 0.000000 -- |    0.960000    |    0.998667    | -- 0.000000 -- |    0.998667    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          fcnn          |    0.960000    | -- 0.000000 -- |    0.960000    |    0.994133    | -- 0.000000 -- |    0.994133    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|         linear         |    0.466667    | -- 0.000000 -- |    0.466667    |    0.725600    | -- 0.000000 -- |    0.725600    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|     random_forest      |    0.960000    | -- 0.000000 -- |    0.960000    |    0.998667    | -- 0.000000 -- |    0.998667    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Bravo! Our AutoML model beats the scikit-learn models ü•≥</p><p>If we are satisfied with the results, we can pack the models up into a zip file</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">auto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;pack&quot;</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>which could be used on our production environments / machines easily:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">unpacked </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Auto</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unpack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;pack&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">predictions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> unpacked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pattern</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cv_x</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="conclusions"></a>Conclusions<a aria-hidden="true" class="hash-link" href="#conclusions" title="Direct link to heading">#</a></h2><p>Contained in this article is just a subset of the features that carefree-learn offers, but we‚Äôve already walked through many basic &amp; common steps we‚Äôll encounter in real life machine learning tasks. Additional capabilities include <a href="https://carefree0910.me/carefree-learn-doc/docs/optimizations#embedding" target="_blank" rel="noopener noreferrer">Fast Embedding</a>, <a href="https://carefree0910.me/carefree-learn-doc/docs/optimizations#one-hot-encoding" target="_blank" rel="noopener noreferrer">One Hot Encoding Caching</a>, <a href="https://carefree0910.me/carefree-learn-doc/docs/developer-guides/customization" target="_blank" rel="noopener noreferrer">highly customizable modules</a>, specify / customize optimizers / lr schedulers, <a href="https://carefree0910.me/carefree-learn-doc/docs/user-guides/production" target="_blank" rel="noopener noreferrer">export to ONNX</a>, and more.</p><p>To learn more about carefree-learn, check out the <a href="https://carefree0910.me/carefree-learn-doc/docs/examples/Titanic" target="_blank" rel="noopener noreferrer">Examples</a> with jupyter notebooks included, as well as the <a href="https://carefree0910.me/carefree-learn-doc/docs/developer-guides/customization" target="_blank" rel="noopener noreferrer">Developer‚Äôs Guide</a> to see how do we customize models with carefree-learn. We sincerely hope that carefree-learn could help you either deal with tabular datasets easier or develop new algorithms on tabular datasets easier, and any contributions to carefree-learn would truly be welcomed.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/carefree-learn-doc/blog/tags/carefree-learn">carefree-learn</a></div></footer></article><div></div></main><div class="col col--2"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-carefree-learn" class="table-of-contents__link">Why carefree-learn?</a><ul><li><a href="#carefree-using" class="table-of-contents__link">Carefree using</a></li><li><a href="#carefree-developing" class="table-of-contents__link">Carefree developing</a></li></ul></li><li><a href="#why-pytorch" class="table-of-contents__link">Why PyTorch?</a></li><li><a href="#getting-started-with-iris" class="table-of-contents__link">Getting Started with Iris</a><ul><li><a href="#inspect-the-iris-dataset" class="table-of-contents__link">Inspect the Iris Dataset</a></li><li><a href="#basic-usages" class="table-of-contents__link">Basic Usages</a></li><li><a href="#benchmarking" class="table-of-contents__link">Benchmarking</a></li><li><a href="#advanced-benchmarking" class="table-of-contents__link">Advanced Benchmarking</a></li><li><a href="#automl-on-iris" class="table-of-contents__link">AutoML on Iris</a></li></ul></li><li><a href="#conclusions" class="table-of-contents__link">Conclusions</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/docs/getting-started/installation/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/docs/getting-started/quick-start">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/docs/design-principles/">Design Principles</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/carefree0910" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright ¬© 2020 carefree-learn, carefree0910. Built with Docusaurus.</div></div></div></footer></div>
<script src="/carefree-learn-doc/styles.a6aa9387.js"></script>
<script src="/carefree-learn-doc/runtime~main.23e4d0f1.js"></script>
<script src="/carefree-learn-doc/main.776c50ea.js"></script>
<script src="/carefree-learn-doc/1.82f460cf.js"></script>
<script src="/carefree-learn-doc/2.b1a07c36.js"></script>
<script src="/carefree-learn-doc/ccc49370.1edb6af6.js"></script>
<script src="/carefree-learn-doc/a5e08a40.07d56649.js"></script>
<script src="/carefree-learn-doc/1d039b86.bef88d6e.js"></script>
</body>
</html>