(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{107:function(e,a,t){"use strict";t.d(a,"a",(function(){return j})),t.d(a,"b",(function(){return i}));var s=t(0),n=t.n(s);function m(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function b(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);a&&(s=s.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,s)}return t}function p(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?b(Object(t),!0).forEach((function(a){m(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function c(e,a){if(null==e)return{};var t,s,n=function(e,a){if(null==e)return{};var t,s,n={},m=Object.keys(e);for(s=0;s<m.length;s++)t=m[s],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(e);for(s=0;s<m.length;s++)t=m[s],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var r=n.a.createContext({}),O=function(e){var a=n.a.useContext(r),t=a;return e&&(t="function"==typeof e?e(a):p(p({},a),e)),t},j=function(e){var a=O(e.components);return n.a.createElement(r.Provider,{value:a},e.children)},l={inlineCode:"code",wrapper:function(e){var a=e.children;return n.a.createElement(n.a.Fragment,{},a)}},N=n.a.forwardRef((function(e,a){var t=e.components,s=e.mdxType,m=e.originalType,b=e.parentName,r=c(e,["components","mdxType","originalType","parentName"]),j=O(t),N=s,i=j["".concat(b,".").concat(N)]||j[N]||l[N]||m;return t?n.a.createElement(i,p(p({ref:a},r),{},{components:t})):n.a.createElement(i,p({ref:a},r))}));function i(e,a){var t=arguments,s=a&&a.mdxType;if("string"==typeof e||s){var m=t.length,b=new Array(m);b[0]=N;var p={};for(var c in a)hasOwnProperty.call(a,c)&&(p[c]=a[c]);p.originalType=e,p.mdxType="string"==typeof e?e:s,b[1]=p;for(var r=2;r<m;r++)b[r]=t[r];return n.a.createElement.apply(null,b)}return n.a.createElement.apply(null,t)}N.displayName="MDXCreateElement"},69:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return b})),t.d(a,"metadata",(function(){return p})),t.d(a,"rightToc",(function(){return c})),t.d(a,"default",(function(){return O}));var s=t(3),n=t(7),m=(t(0),t(107)),b={id:"optimizations",title:"Optimizations"},p={unversionedId:"optimizations",id:"optimizations",isDocsHomePage:!1,title:"Optimizations",description:"carefree-learn not only provides carefree APIs for easier usages, but also did quite a few optimizations to make training on tabular datasets faster than other similar libraries. In this page we'll introduce some techniques carefree-learn adopted under the hood, and will show how much performance boost we've obtained with them.",source:"@site/docs/optimizations.md",slug:"/optimizations",permalink:"/carefree-learn-doc/docs/optimizations",version:"current",lastUpdatedAt:1605886002,sidebar:"docs",previous:{title:"Design Principles",permalink:"/carefree-learn-doc/docs/design-principles"},next:{title:"Installation",permalink:"/carefree-learn-doc/docs/getting-started/installation"}},c=[{value:"Categorical Encodings",id:"categorical-encodings",children:[{value:"One Hot Encoding",id:"one-hot-encoding",children:[]},{value:"Embedding",id:"embedding",children:[]},{value:"Sparsity",id:"sparsity",children:[]}]}],r={rightToc:c};function O(e){var a=e.components,t=Object(n.a)(e,["components"]);return Object(m.b)("wrapper",Object(s.a)({},r,t,{components:a,mdxType:"MDXLayout"}),Object(m.b)("p",null,Object(m.b)("inlineCode",{parentName:"p"},"carefree-learn")," not only provides ",Object(m.b)("em",{parentName:"p"},"carefree")," APIs for easier usages, but also did quite a few optimizations to make training on tabular datasets faster than other similar libraries. In this page we'll introduce some techniques ",Object(m.b)("inlineCode",{parentName:"p"},"carefree-learn")," adopted under the hood, and will show how much performance boost we've obtained with them."),Object(m.b)("h2",{id:"categorical-encodings"},"Categorical Encodings"),Object(m.b)("p",null,"Encoding categorical features is one of the most important pre-processing we need to perform on tabular datasets. As mentioned in ",Object(m.b)("a",Object(s.a)({parentName:"p"},{href:"./design-principles#transform"}),Object(m.b)("inlineCode",{parentName:"a"},"Design Principles")),", ",Object(m.b)("inlineCode",{parentName:"p"},"carefree-learn")," will stick to ",Object(m.b)("a",Object(s.a)({parentName:"p"},{href:"#one-hot-encoding"}),Object(m.b)("inlineCode",{parentName:"a"},"one_hot"))," encoding and ",Object(m.b)("a",Object(s.a)({parentName:"p"},{href:"#embedding"}),Object(m.b)("inlineCode",{parentName:"a"},"embedding"))," encoding, which will be introduced in turn in the following sections."),Object(m.b)("h3",{id:"one-hot-encoding"},"One Hot Encoding"),Object(m.b)("p",null,"A ",Object(m.b)("inlineCode",{parentName:"p"},"one_hot")," encoding basically encodes categorical features as a one-hot numeric array, as defined in ",Object(m.b)("a",Object(s.a)({parentName:"p"},{href:"https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html"}),Object(m.b)("inlineCode",{parentName:"a"},"sklearn")),". Suppose we have 5 classes in total, then:"),Object(m.b)("div",{className:"math math-display"},Object(m.b)("span",Object(s.a)({parentName:"div"},{className:"katex-display"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("mtext",{parentName:"mrow"},"OneHot"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"("),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),")"),Object(m.b)("mo",{parentName:"mrow"},"="),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"["),Object(m.b)("mn",{parentName:"mrow"},"1"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"]"),Object(m.b)("mspace",Object(s.a)({parentName:"mrow"},{linebreak:"newline"})),Object(m.b)("mtext",{parentName:"mrow"},"OneHot"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"("),Object(m.b)("mn",{parentName:"mrow"},"3"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),")"),Object(m.b)("mo",{parentName:"mrow"},"="),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"["),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"1"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"]")),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"\\text{OneHot}(0) = [1,0,0,0,0] \\\\ \\text{OneHot}(3) = [0,0,0,1,0]")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"OneHot")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mopen"}),"("),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mclose"}),")"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mrel"}),"="),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mopen"}),"["),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"1"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mclose"}),"]")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace newline"})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"OneHot")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mopen"}),"("),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"3"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mclose"}),")"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mrel"}),"="),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mopen"}),"["),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"1"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mclose"}),"]")))))),Object(m.b)("p",null,"We can figure out that this kind of encoding is ",Object(m.b)("strong",{parentName:"p"},"static"),", which means it will not change during the training process. In this case, we can cache down all the encodings and access them through indexing. This will speed up the encoding process for ~66x:"),Object(m.b)("pre",null,Object(m.b)("code",Object(s.a)({parentName:"pre"},{className:"language-python"}),"import numpy as np\nfrom sklearn.preprocessing import OneHotEncoder\n\nnum_data = 10000\nnum_classes = 10\nbatch_size = 128\n\nx = np.random.randint(0, num_classes, num_data).reshape([-1, 1])\nenc = OneHotEncoder(sparse=False).fit(x)\nx_one_hot = enc.transform(x)\n\ntarget_indices = np.random.permutation(num_data)[:batch_size]\nx_target = x[target_indices]\n\nassert np.allclose(x_one_hot[target_indices], enc.transform(x_target))\n%timeit x_one_hot[target_indices]  # 2.97 \xb5s \xb1 22.4 ns\n%timeit enc.transform(x_target)    # 207 \xb5s \xb1 4.05 \xb5s\n")),Object(m.b)("p",null,"The gap will decrease a little when we increase ",Object(m.b)("inlineCode",{parentName:"p"},"num_classes")," to a larger number, let's say 100:"),Object(m.b)("pre",null,Object(m.b)("code",Object(s.a)({parentName:"pre"},{className:"language-python"}),"%timeit x_one_hot[target_indices]  # 6.26 \xb5s \xb1 81 ns\n%timeit enc.transform(x_target)    # 201 \xb5s \xb1 1.98 \xb5s\n")),Object(m.b)("p",null,"However there are still ~33x boost."),Object(m.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(m.b)("div",Object(s.a)({parentName:"div"},{className:"admonition-heading"}),Object(m.b)("h5",{parentName:"div"},Object(m.b)("span",Object(s.a)({parentName:"h5"},{className:"admonition-icon"}),Object(m.b)("svg",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(m.b)("path",Object(s.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(m.b)("div",Object(s.a)({parentName:"div"},{className:"admonition-content"}),Object(m.b)("p",{parentName:"div"},"Although caching can boost performance, it is at the cost of consuming much more memories. A better solution should be caching sparse tensors instead of dense ones, but ",Object(m.b)("inlineCode",{parentName:"p"},"PyTorch")," has not supported sparsity good enough. See ",Object(m.b)("a",Object(s.a)({parentName:"p"},{href:"#sparsity"}),"Sparsity")," section for more details."))),Object(m.b)("h3",{id:"embedding"},"Embedding"),Object(m.b)("p",null,"An ",Object(m.b)("inlineCode",{parentName:"p"},"embedding")," encoding actually borrows from ",Object(m.b)("strong",{parentName:"p"},"N"),"atual ",Object(m.b)("strong",{parentName:"p"},"L"),"anguage ",Object(m.b)("strong",{parentName:"p"},"P"),"rocessing (",Object(m.b)("strong",{parentName:"p"},"NLP"),") where they converted (sparse) input words into dense embeddings with embedding look up. It is quite trivial to turn categorical features into embeddings with the same look up techniques, but tabular datasets hold a different property compared with ",Object(m.b)("strong",{parentName:"p"},"NLP"),": tabular datasets will maintain many embedding tables because they have different categorical features with different number of values, while in ",Object(m.b)("strong",{parentName:"p"},"NLP")," it only need to maintain one embedding table in most cases."),Object(m.b)("p",null,"Since ",Object(m.b)("inlineCode",{parentName:"p"},"embedding")," is a ",Object(m.b)("strong",{parentName:"p"},"dynamic")," encoding which contains trainable parameters, we cannot cache them beforehand like we did to ",Object(m.b)("inlineCode",{parentName:"p"},"one_hot"),". However, we can still optimize it with ",Object(m.b)("em",{parentName:"p"},"fast embedding"),". A ",Object(m.b)("em",{parentName:"p"},"fast embedding")," basically unifies the embedding dimension of different categorical features, so one unified embedding table is sufficient for the whole ",Object(m.b)("inlineCode",{parentName:"p"},"embedding")," process."),Object(m.b)("p",null,"There's one more thing we need to take care of when applying ",Object(m.b)("em",{parentName:"p"},"fast embedding"),": we need to ",Object(m.b)("em",{parentName:"p"},"increment")," the values of each categorical features. Here's a minimal example to illustrate this. Suppose we have two categorical features (",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"1")),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"2"))),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"x_1, x_2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"1")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))))))),") with 2 and 3 classes respectively, then our embedding table will contain 5 rows:"),Object(m.b)("div",{className:"math math-display"},Object(m.b)("span",Object(s.a)({parentName:"div"},{className:"katex-display"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{fence:"true"}),"["),Object(m.b)("mtable",Object(s.a)({parentName:"mrow"},{rowspacing:"0.15999999999999992em",columnspacing:"1em"}),Object(m.b)("mtr",{parentName:"mtable"},Object(m.b)("mtd",{parentName:"mtr"},Object(m.b)("mstyle",Object(s.a)({parentName:"mtd"},{scriptlevel:"0",displaystyle:"false"}),Object(m.b)("mrow",{parentName:"mstyle"},Object(m.b)("mtext",{parentName:"mrow"},"\u2014\u2014\xa0"),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"1")),Object(m.b)("mtext",{parentName:"mrow"},"\xa0\u2014\u2014"))))),Object(m.b)("mtr",{parentName:"mtable"},Object(m.b)("mtd",{parentName:"mtr"},Object(m.b)("mstyle",Object(s.a)({parentName:"mtd"},{scriptlevel:"0",displaystyle:"false"}),Object(m.b)("mrow",{parentName:"mstyle"},Object(m.b)("mtext",{parentName:"mrow"},"\u2014\u2014\xa0"),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"2")),Object(m.b)("mtext",{parentName:"mrow"},"\xa0\u2014\u2014"))))),Object(m.b)("mtr",{parentName:"mtable"},Object(m.b)("mtd",{parentName:"mtr"},Object(m.b)("mstyle",Object(s.a)({parentName:"mtd"},{scriptlevel:"0",displaystyle:"false"}),Object(m.b)("mrow",{parentName:"mstyle"},Object(m.b)("mtext",{parentName:"mrow"},"\u2014\u2014\xa0"),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"3")),Object(m.b)("mtext",{parentName:"mrow"},"\xa0\u2014\u2014"))))),Object(m.b)("mtr",{parentName:"mtable"},Object(m.b)("mtd",{parentName:"mtr"},Object(m.b)("mstyle",Object(s.a)({parentName:"mtd"},{scriptlevel:"0",displaystyle:"false"}),Object(m.b)("mrow",{parentName:"mstyle"},Object(m.b)("mtext",{parentName:"mrow"},"\u2014\u2014\xa0"),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"4")),Object(m.b)("mtext",{parentName:"mrow"},"\xa0\u2014\u2014"))))),Object(m.b)("mtr",{parentName:"mtable"},Object(m.b)("mtd",{parentName:"mtr"},Object(m.b)("mstyle",Object(s.a)({parentName:"mtd"},{scriptlevel:"0",displaystyle:"false"}),Object(m.b)("mrow",{parentName:"mstyle"},Object(m.b)("mtext",{parentName:"mrow"},"\u2014\u2014\xa0"),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"5")),Object(m.b)("mtext",{parentName:"mrow"},"\xa0\u2014\u2014")))))),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{fence:"true"}),"]")),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"\\begin{bmatrix} \\text{---} \\text{---} \\ v_1 \\ \\text{---} \\text{---} \\\\ \\text{---} \\text{---} \\ v_2 \\ \\text{---} \\text{---} \\\\ \\text{---} \\text{---} \\ v_3 \\ \\text{---} \\text{---} \\\\ \\text{---} \\text{---} \\ v_4 \\ \\text{---} \\text{---} \\\\ \\text{---} \\text{---} \\ v_5 \\ \\text{---} \\text{---} \\end{bmatrix}")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"6.00503em",verticalAlign:"-2.75004em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"minner"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mopen"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizing mult"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"3.2549900000000003em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-1.0499800000000006em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a3"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.1999800000000005em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a2"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.79598em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a2"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-3.39198em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a2"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-3.9879800000000003em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a2"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-4.0139700000000005em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a2"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-5.25499em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a1")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"2.75004em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mtable"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"col-align-c"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"3.2500000000000004em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-5.410000000000001em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"1")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-4.21em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-3.01em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"3")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-1.8099999999999998em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"4")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-0.6099999999999997em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"5")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace"}),"\xa0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"\u2014"))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"2.7500000000000004em"}}),Object(m.b)("span",{parentName:"span"}))))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mclose"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizing mult"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"3.2549900000000003em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-1.0499800000000006em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a6"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.1999800000000005em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a5"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.79598em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a5"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-3.39198em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a5"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-3.9879800000000003em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a5"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-4.0139700000000005em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a5"))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-5.25499em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3.1550000000000002em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"delimsizinginner delim-size4"}),Object(m.b)("span",{parentName:"span"},"\u23a4")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"2.75004em"}}),Object(m.b)("span",{parentName:"span"})))))))))))),Object(m.b)("p",null,"In this table, the first two rows belong to ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"1"))),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"x_1")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.58056em",verticalAlign:"-0.15em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"1")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))))))),", while the last three rows belong to ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"2"))),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"x_2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.58056em",verticalAlign:"-0.15em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))))))),". However, as we defined above, ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"1")),Object(m.b)("mo",{parentName:"mrow"},"\u2208"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"{"),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"1"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"}")),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"x_1\\in\\{0,1\\}")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.6891em",verticalAlign:"-0.15em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"1")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mrel"}),"\u2208"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mopen"}),"{"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"1"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mclose"}),"}")))))," and ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"2")),Object(m.b)("mo",{parentName:"mrow"},"\u2208"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"{"),Object(m.b)("mn",{parentName:"mrow"},"0"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"1"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"2"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"}")),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"x_2\\in\\{0,1,2\\}")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.6891em",verticalAlign:"-0.15em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mrel"}),"\u2208"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mopen"}),"{"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"0"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"1"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"2"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mclose"}),"}"))))),". In order to assign ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"3")),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"4")),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"5"))),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"v_3,v_4,v_5")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"3")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"4")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"5")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"}))))))))))," to ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"2"))),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"x_2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.58056em",verticalAlign:"-0.15em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))))))),", we need to ",Object(m.b)("em",{parentName:"p"},"increment")," ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"2"))),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"x_2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.58056em",verticalAlign:"-0.15em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"}))))))))))," by ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("mn",{parentName:"mrow"},"2")),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.64444em",verticalAlign:"0em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"2")))))," (which is the number of choices ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"1"))),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"x_1")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.58056em",verticalAlign:"-0.15em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"1")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"}))))))))))," could have). After ",Object(m.b)("em",{parentName:"p"},"increment"),", we have ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"x"),Object(m.b)("mn",{parentName:"msub"},"2")),Object(m.b)("mo",{parentName:"mrow"},"\u2208"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"{"),Object(m.b)("mn",{parentName:"mrow"},"2"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"3"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("mn",{parentName:"mrow"},"4"),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{stretchy:"false"}),"}")),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"x_2\\in\\{2,3,4\\}")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.6891em",verticalAlign:"-0.15em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal"}),"x"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"2")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mrel"}),"\u2208"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mopen"}),"{"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"2"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"3"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"4"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mclose"}),"}")))))," so it can successfully look up ",Object(m.b)("span",Object(s.a)({parentName:"p"},{className:"math math-inline"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"3")),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"4")),Object(m.b)("mo",Object(s.a)({parentName:"mrow"},{separator:"true"}),","),Object(m.b)("msub",{parentName:"mrow"},Object(m.b)("mi",{parentName:"msub"},"v"),Object(m.b)("mn",{parentName:"msub"},"5"))),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"v_3,v_4,v_5")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"3")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"4")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mpunct"}),","),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"msupsub"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"-0.03588em",marginRight:"0.05em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord mtight"}),"5")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),Object(m.b)("span",{parentName:"span"})))))))))),"."),Object(m.b)("p",null,"Note that the ",Object(m.b)("em",{parentName:"p"},"incremented")," indices are ",Object(m.b)("strong",{parentName:"p"},"static"),", so ",Object(m.b)("inlineCode",{parentName:"p"},"carefree-learn")," will cache these indices to avoid duplicate calculations when ",Object(m.b)("em",{parentName:"p"},"fast embedding")," is applied."),Object(m.b)("p",null,"Since the embedding dimensions are unified, ",Object(m.b)("em",{parentName:"p"},"fast embedding")," actually reduces the flexibility a little bit, but it can speed up the encoding process for ~17.5x:"),Object(m.b)("pre",null,Object(m.b)("code",Object(s.a)({parentName:"pre"},{className:"language-python"}),"import math\nimport torch\nimport numpy as np\nfrom torch.nn import Embedding\nfrom cflearn.misc.toolkit import to_torch\n\ndim = 20\nbatch_size = 256\n\nfeatures = []\nembeddings = []\nfor i in range(dim):\n    # 5, 10, 15, 20\n    num_classes = math.ceil((i + 1) / 5) * 5\n    x = np.random.randint(0, num_classes, batch_size).reshape([-1, 1])\n    embedding = Embedding(num_classes, 1)\n    embeddings.append(embedding)\n    features.append(x)\n\nfast_embedding = Embedding(250, 1)\ntensor = to_torch(np.hstack(features)).to(torch.long)\n\ndef f1():\n    return fast_embedding(tensor)\n\ndef f2():\n    embedded = []\n    for i, embedding in enumerate(embeddings):\n        embedded.append(embedding(tensor[..., i:i+1]))\n    return torch.cat(embedded, dim=1)\n\nassert f1().shape == f2().shape\n%timeit f1()  # 33.6 \xb5s \xb1 506 ns\n%timeit f2()  # 587 \xb5s \xb1 3.02 \xb5s\n")),Object(m.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(m.b)("div",Object(s.a)({parentName:"div"},{className:"admonition-heading"}),Object(m.b)("h5",{parentName:"div"},Object(m.b)("span",Object(s.a)({parentName:"h5"},{className:"admonition-icon"}),Object(m.b)("svg",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(m.b)("path",Object(s.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(m.b)("div",Object(s.a)({parentName:"div"},{className:"admonition-content"}),Object(m.b)("p",{parentName:"div"},"Theoratically, ",Object(m.b)("inlineCode",{parentName:"p"},"embedding")," encoding is nothing more than a ",Object(m.b)("inlineCode",{parentName:"p"},"one_hot")," encoding followed by a linear projection, so it should be fast enough if we apply sparse matrix multiplications between ",Object(m.b)("inlineCode",{parentName:"p"},"one_hot")," encodings and a block diagnal ",Object(m.b)("inlineCode",{parentName:"p"},"embedding")," look up table. However as mentioned in ",Object(m.b)("a",Object(s.a)({parentName:"p"},{href:"#one-hot-encoding"}),"One Hot Encoding")," section, ",Object(m.b)("inlineCode",{parentName:"p"},"PyTorch")," has not supported sparsity good enough. See ",Object(m.b)("a",Object(s.a)({parentName:"p"},{href:"#sparsity"}),"Sparsity")," section for more details."))),Object(m.b)("h3",{id:"sparsity"},"Sparsity"),Object(m.b)("p",null,"It is quite trivial that the ",Object(m.b)("inlineCode",{parentName:"p"},"one_hot")," encoding actually outputs a sparse matrix with sparsity equals to:"),Object(m.b)("div",{className:"math math-display"},Object(m.b)("span",Object(s.a)({parentName:"div"},{className:"katex-display"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-mathml"}),Object(m.b)("math",Object(s.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}),Object(m.b)("semantics",{parentName:"math"},Object(m.b)("mrow",{parentName:"semantics"},Object(m.b)("mn",{parentName:"mrow"},"1"),Object(m.b)("mo",{parentName:"mrow"},"\u2212"),Object(m.b)("mfrac",{parentName:"mrow"},Object(m.b)("mn",{parentName:"mfrac"},"1"),Object(m.b)("mtext",{parentName:"mfrac"},"num_classes"))),Object(m.b)("annotation",Object(s.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"1-\\frac{1}{\\text{num\\_classes}}")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"0.72777em",verticalAlign:"-0.08333em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"1"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mbin"}),"\u2212"),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}}))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"base"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"strut",style:{height:"2.31744em",verticalAlign:"-0.996em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mopen nulldelimiter"})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mfrac"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-t vlist-t2"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"1.32144em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-2.314em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord text"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"num_classes")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-3.23em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"frac-line",style:{borderBottomWidth:"0.04em"}}))),Object(m.b)("span",Object(s.a)({parentName:"span"},{style:{top:"-3.677em"}}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mord"}),"1")))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-s"}),"\u200b")),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist-r"}),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"vlist",style:{height:"0.996em"}}),Object(m.b)("span",{parentName:"span"}))))),Object(m.b)("span",Object(s.a)({parentName:"span"},{className:"mclose nulldelimiter"})))))))),Object(m.b)("p",null,"So the sparsity could easily exceed 90% when ",Object(m.b)("inlineCode",{parentName:"p"},"num_classes")," only needs to be greater than 10, therefore it is quite natural to think of leveraging sparse data structures to cache these ",Object(m.b)("inlineCode",{parentName:"p"},"one_hot")," encodings. What's better is that the ",Object(m.b)("inlineCode",{parentName:"p"},"embedding")," encoding could be represented as sparse matrix multiplications between ",Object(m.b)("inlineCode",{parentName:"p"},"one_hot")," encodings and a block diagnal ",Object(m.b)("inlineCode",{parentName:"p"},"embedding")," look up table, so ",Object(m.b)("strong",{parentName:"p"},"THEORATICALLY")," (\ud83e\udd23) we could reuse the ",Object(m.b)("inlineCode",{parentName:"p"},"one_hot")," encodings to get the ",Object(m.b)("inlineCode",{parentName:"p"},"embedding")," encodings efficiently."),Object(m.b)("p",null,"Unfortunately, although ",Object(m.b)("a",Object(s.a)({parentName:"p"},{href:"https://docs.scipy.org/doc/scipy/reference/sparse.html"}),Object(m.b)("inlineCode",{parentName:"a"},"scipy"))," supports sparse matrices pretty well, ",Object(m.b)("inlineCode",{parentName:"p"},"PyTorch")," has not yet supported them good enough. So we'll stick to the dense solutions mentioned above, but will switch to the sparse ones iff ",Object(m.b)("inlineCode",{parentName:"p"},"PyTorch")," releases some fancy sparsity supports!"))}O.isMDXComponent=!0}}]);