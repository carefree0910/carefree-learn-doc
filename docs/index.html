<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><title data-react-helmet="true">Introduction | carefree-learn</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Introduction | carefree-learn"><meta data-react-helmet="true" name="description" content="Advantages"><meta data-react-helmet="true" property="og:description" content="Advantages"><meta data-react-helmet="true" property="og:url" content="https://carefree0910.me/carefree-learn-doc/docs/"><link data-react-helmet="true" rel="shortcut icon" href="/carefree-learn-doc/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://carefree0910.me/carefree-learn-doc/docs/"><link rel="stylesheet" href="/carefree-learn-doc/styles.fd85c772.css">
<link rel="preload" href="/carefree-learn-doc/styles.ce95972e.js" as="script">
<link rel="preload" href="/carefree-learn-doc/runtime~main.ba3e9fb6.js" as="script">
<link rel="preload" href="/carefree-learn-doc/main.730c1afe.js" as="script">
<link rel="preload" href="/carefree-learn-doc/1.bcdeeea8.js" as="script">
<link rel="preload" href="/carefree-learn-doc/37.9de810af.js" as="script">
<link rel="preload" href="/carefree-learn-doc/39.0b235987.js" as="script">
<link rel="preload" href="/carefree-learn-doc/935f2afb.d389a15a.js" as="script">
<link rel="preload" href="/carefree-learn-doc/36.2b40965e.js" as="script">
<link rel="preload" href="/carefree-learn-doc/a09c2993.804f6f5c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/carefree-learn-doc/"><strong class="navbar__title">carefree-learn</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/carefree-learn-doc/docs/">Docs</a><a class="navbar__item navbar__link" href="/carefree-learn-doc/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/carefree-learn-doc/"><strong class="navbar__title">carefree-learn</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/carefree-learn-doc/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/carefree-learn-doc/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">carefree-learn</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/carefree-learn-doc/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/carefree-learn-doc/docs/design-principles">Design Principles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/carefree-learn-doc/docs/optimizations">Optimizations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/getting-started/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/getting-started/quick-start">Quick Start</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/getting-started/configurations">Configurations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">User Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/user-guides/auto-ml">AutoML</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/user-guides/distributed">Distributed</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/user-guides/examples">Examples</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Developer Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/developer-guides/build-your-own-models">Models</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/about/release-notes">Release Notes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/about/license">License</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Introduction</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="advantages"></a>Advantages<a aria-hidden="true" class="hash-link" href="#advantages" title="Direct link to heading">#</a></h2><p>Like many similar projects, <code>carefree-learn</code> can be treated as a high-level library to help with training neural networks in PyTorch. However, <code>carefree-learn</code> does less and more than that.</p><ul><li><code>carefree-learn</code> focuses on tabular (structured) datasets, instead of unstructured datasets (e.g. NLP datasets or CV datasets).</li><li><code>carefree-learn</code> provides an end-to-end pipeline on tabular datasets, including <strong>AUTOMATICALLY</strong> deal with (this part is mainly handled by <a href="https://github.com/carefree0910/carefree-data" target="_blank" rel="noopener noreferrer"><code>carefree-data</code></a>, though):<ul><li>Detection of redundant feature columns which can be excluded (all SAME, all DIFFERENT, etc).</li><li>Detection of feature columns types (whether a feature column is string column / numerical column / categorical column).</li><li>Imputation of missing values.</li><li>Encoding of string columns and categorical columns (Embedding or One Hot Encoding).</li><li>Pre-processing of numerical columns (Normalize, Min Max, etc.).</li><li>And much more...</li></ul></li><li><code>carefree-learn</code> can help you deal with almost <strong>ANY</strong> kind of tabular datasets, no matter how <em>dirty</em> and <em>messy</em> it is. It can be either trained directly with some numpy arrays, or trained indirectly with some files locate on your machine. This makes <code>carefree-learn</code> stand out from similar projects.</li><li><code>carefree-learn</code> is <strong>highly customizable</strong> for developers. We have already wrapped (almost) every single functionality / process into a single module (a Python class), and they can be replaced or enhanced either directly from source codes or from local codes with the help of some pre-defined functions provided by <code>carefree-learn</code> (see <a href="/carefree-learn-doc/docs/design-principles#registration"><code>Registration</code></a>).</li><li><code>carefree-learn</code> supports easy-to-use saving and loading. By default, everything will be wrapped into a zip file!</li><li><code>carefree-learn</code> supports <a href="/carefree-learn-doc/docs/user-guides/distributed#distributed-training"><code>Distributed Training</code></a>.</li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>From the discriptions above, you might notice that <code>carefree-learn</code> is more of a minimal <strong>Automatic Machine Learning</strong> (AutoML) solution than a pure Machine Learning package.</p></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>When we say <strong>ANY</strong>, it means that <code>carefree-learn</code> can even train on one single sample.</p><details><summary><b>For example</b></summary><p></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cflearn</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">toy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">make_toy_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> toy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tr_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">converted</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;x=</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">data</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, y=</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">data</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">y</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># x=[[0.]], y=[[1.]]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p></p></details><br><p>This is especially useful when we need to do unittests or to verify whether our custom modules (e.g. custom pre-processes) are correctly integrated into <code>carefree-learn</code>.</p><details><summary><b>For example</b></summary><p></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cflearn</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># here we implement a custom processor</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@cflearn</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">register_processor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;plus_one&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PlusOne</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Processor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    @</span><span class="token builtin">property</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">input_dim</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    @</span><span class="token builtin">property</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">output_dim</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ndarray</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Processor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ndarray</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ndarray</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> columns </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_recover</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> processed_columns</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ndarray</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ndarray</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> processed_columns </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># we need to specify that we use the custom process method to process our labels</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;data_config&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;label_process_method&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;plus_one&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">toy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">make_toy_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> toy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tr_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">converted</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span></div><div class="token-line" style="color:#393A34"><span class="token plain">processed_y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> toy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tr_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;y=</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">y</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, new_y=</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">processed_y</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># y=[[1.]], new_y=[[2.]]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p></p></details></div></div><p>There is one more thing we&#x27;d like to mention: <code>carefree-learn</code> is <em><a href="https://pandas.pydata.org/" target="_blank" rel="noopener noreferrer">Pandas</a>-free</em>. The reasons why we excluded <a href="https://pandas.pydata.org/" target="_blank" rel="noopener noreferrer">Pandas</a> are listed in <a href="https://github.com/carefree0910/carefree-data" target="_blank" rel="noopener noreferrer"><code>carefree-data</code></a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="configurations"></a>Configurations<a aria-hidden="true" class="hash-link" href="#configurations" title="Direct link to heading">#</a></h2><p>In <code>carefree-learn</code>, we have few args and kwargs in each module. Instead, we&#x27;ll use one single argument <a href="/carefree-learn-doc/docs/getting-started/configurations#environment"><code>Environment</code></a> to handle the configurations. That&#x27;s why we can easily support JSON configuration, which is very useful when you need to share your models to others or reproduce others&#x27; works.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="data-loading-strategy"></a>Data Loading Strategy<a aria-hidden="true" class="hash-link" href="#data-loading-strategy" title="Direct link to heading">#</a></h2><p>Since <code>carefree-learn</code> focuses on tabular datasets, the data loading strategy is very different from unstructured datasets&#x27; strategy. For instance, it is quite common that a CV dataset is a bunch of pictures located in a folder, and we will either read them sequentially or read them in parallel. Nowadays, almost every famous deep learning framework has their own solution to load unstructured datasets efficiently, e.g. PyTorch officially implements <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" target="_blank" rel="noopener noreferrer">DataLoader</a> to support multi-process loading and other features.</p><p>Although we know that RAM speed is (almost) always faster than I/O operations, we still prefer leveraging multi-process to read files than loading them all into RAM at once. This is because unstructured datasets are often too large to allocate them all to RAM. However, when it comes to tabular datasets, we prefer to load everything into RAM at the very beginning. The main reasons are listed below:</p><ul><li>Tabular datasets are often quite small and are able to put into RAM at once.</li><li>Network structures for tabular datasets are often much smaller, which means using multi-process loading will cause a much heavier overhead.</li><li>We need to take <a href="/carefree-learn-doc/docs/user-guides/distributed#distributed-training"><code>Distributed Training</code></a> into account. If we stick to multi-process loading, there would be too many threads in the pool which is not a good practice.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="terminologies"></a>Terminologies<a aria-hidden="true" class="hash-link" href="#terminologies" title="Direct link to heading">#</a></h2><p>In <code>carefree-learn</code>, there are some frequently used terminologies, and we will introduce them in this section. If you are confused by some other terminologies in <code>carefree-learn</code> when you are using it, feel free to edit this list:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="step"></a>step<a aria-hidden="true" class="hash-link" href="#step" title="Direct link to heading">#</a></h3><p>One <strong><code>step</code></strong> in the training process means that one mini-batch passed through our model.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="epoch"></a>epoch<a aria-hidden="true" class="hash-link" href="#epoch" title="Direct link to heading">#</a></h3><p>In most deep learning processes, training is structured into epochs. An epoch is one iteration over the entire input data, which is constructed by several <strong><code>step</code></strong>s.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="batch_size"></a>batch_size<a aria-hidden="true" class="hash-link" href="#batch_size" title="Direct link to heading">#</a></h3><p>It is a good practice to slice the data into smaller batches and iterates over these batches during training, and <strong><code>batch_size</code></strong> specifies the size of each batch. Be aware that the last batch may be smaller if the total number of samples is not divisible by the <strong><code>batch_size</code></strong>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="config"></a>config<a aria-hidden="true" class="hash-link" href="#config" title="Direct link to heading">#</a></h3><p>A <strong><code>config</code></strong> indicates the main part (or, the shared part) of the configuration.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="increment_config"></a>increment_config<a aria-hidden="true" class="hash-link" href="#increment_config" title="Direct link to heading">#</a></h3><p>An <strong><code>increment_config</code></strong> indicates the configurations that you want to update on <strong><code>config</code></strong>.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>This is very useful when you only want to tune a single configuration and yet you have tons of other configurations need to be fixed. In this case, you can set other configurations as <strong><code>config</code></strong>, and adjust the target configuration in <strong><code>increment_config</code></strong>.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="forward"></a>forward<a aria-hidden="true" class="hash-link" href="#forward" title="Direct link to heading">#</a></h3><p>A <strong><code>forward</code></strong> method is a common method required by (almost) all PyTorch modules.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p><a href="https://discuss.pytorch.org/t/about-the-nn-module-forward/20858" target="_blank" rel="noopener noreferrer">Here</a> is a nice discussion.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="task_type"></a>task_type<a aria-hidden="true" class="hash-link" href="#task_type" title="Direct link to heading">#</a></h3><p>We use <code>task_type = &quot;clf&quot;</code> to indicate a classification task, and <code>task_type = &quot;reg&quot;</code> to indicate a regression task.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>And we&#x27;ll convert them into <a href="https://github.com/carefree0910/carefree-data/blob/82f158be82ced404a1f4ac37e7a669a50470b109/cfdata/tabular/misc.py#L126" target="_blank" rel="noopener noreferrer">cfdata.tabular.TaskTypes</a> under the hood.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tr-cv--te"></a>tr, cv &amp; te<a aria-hidden="true" class="hash-link" href="#tr-cv--te" title="Direct link to heading">#</a></h3><p>In most cases, we use:</p><ul><li><code>x_tr</code>, <code>x_cv</code> and <code>x_te</code> to represent <code>training</code>, <code>cross validation</code> and <code>test</code> <strong>features</strong>.</li><li><code>y_tr</code>, <code>y_cv</code> and <code>y_te</code> to represent <code>training</code>, <code>cross validation</code> and <code>test</code> <strong>labels</strong>.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="metrics"></a>metrics<a aria-hidden="true" class="hash-link" href="#metrics" title="Direct link to heading">#</a></h3><p>Although <code>losses</code> are what we optimize directly during training, <code>metrics</code> are what we <em>actually</em> want to optimize (e.g. <code>acc</code>, <code>auc</code>, <code>f1-score</code>, etc.). Sometimes we may want to take multiple <code>metrics</code> into consideration, and we may also want to eliminate the fluctuation comes with mini-batch training by applying EMA on the metrics.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Please refer to <a href="/carefree-learn-doc/docs/getting-started/configurations#metrics">metrics</a> and see how to customize the behaviour of <code>metrics</code> in <code>carefree-learn</code>.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="optimizers"></a>optimizers<a aria-hidden="true" class="hash-link" href="#optimizers" title="Direct link to heading">#</a></h3><p>In PyTorch (and other deep learning framework) we have <code>optimizers</code> to <em>optimize</em> the parameters of our model. We sometimes need to divide the parameters into several groups and optimize them individually (which is quite common in GANs).</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Please refer to <a href="/carefree-learn-doc/docs/getting-started/configurations#optimizers">optimizers</a> and see how to control the behaviour of <code>optimizers</code> in <code>carefree-learn</code>.</p></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-11-20T05:50:11.000Z" class="docLastUpdatedAt_217_">11/20/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/carefree-learn-doc/docs/design-principles"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Design Principles Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#advantages" class="table-of-contents__link">Advantages</a></li><li><a href="#configurations" class="table-of-contents__link">Configurations</a></li><li><a href="#data-loading-strategy" class="table-of-contents__link">Data Loading Strategy</a></li><li><a href="#terminologies" class="table-of-contents__link">Terminologies</a><ul><li><a href="#step" class="table-of-contents__link">step</a></li><li><a href="#epoch" class="table-of-contents__link">epoch</a></li><li><a href="#batch_size" class="table-of-contents__link">batch_size</a></li><li><a href="#config" class="table-of-contents__link">config</a></li><li><a href="#increment_config" class="table-of-contents__link">increment_config</a></li><li><a href="#forward" class="table-of-contents__link">forward</a></li><li><a href="#task_type" class="table-of-contents__link">task_type</a></li><li><a href="#tr-cv--te" class="table-of-contents__link">tr, cv &amp; te</a></li><li><a href="#metrics" class="table-of-contents__link">metrics</a></li><li><a href="#optimizers" class="table-of-contents__link">optimizers</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/docs/getting-started/installation/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/docs/getting-started/quick-start">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/docs/design-principles/">Design Principles</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/carefree0910" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 carefree-learn, carefree0910. Built with Docusaurus.</div></div></div></footer></div>
<script src="/carefree-learn-doc/styles.ce95972e.js"></script>
<script src="/carefree-learn-doc/runtime~main.ba3e9fb6.js"></script>
<script src="/carefree-learn-doc/main.730c1afe.js"></script>
<script src="/carefree-learn-doc/1.bcdeeea8.js"></script>
<script src="/carefree-learn-doc/37.9de810af.js"></script>
<script src="/carefree-learn-doc/39.0b235987.js"></script>
<script src="/carefree-learn-doc/935f2afb.d389a15a.js"></script>
<script src="/carefree-learn-doc/36.2b40965e.js"></script>
<script src="/carefree-learn-doc/a09c2993.804f6f5c.js"></script>
</body>
</html>