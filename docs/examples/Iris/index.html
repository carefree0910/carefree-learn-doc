<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<link rel="search" type="application/opensearchdescription+xml" title="carefree-learn" href="/carefree-learn-doc/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><title data-react-helmet="true">Iris | carefree-learn</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Iris | carefree-learn"><meta data-react-helmet="true" name="description" content="| Python source code | Jupyter Notebook | Task |"><meta data-react-helmet="true" property="og:description" content="| Python source code | Jupyter Notebook | Task |"><meta data-react-helmet="true" property="og:url" content="https://carefree0910.me/carefree-learn-doc/docs/examples/Iris"><link data-react-helmet="true" rel="shortcut icon" href="/carefree-learn-doc/./img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://carefree0910.me/carefree-learn-doc/docs/examples/Iris"><link rel="stylesheet" href="/carefree-learn-doc/styles.cdaa38c7.css">
<link rel="preload" href="/carefree-learn-doc/styles.dfcd65fb.js" as="script">
<link rel="preload" href="/carefree-learn-doc/runtime~main.87def90a.js" as="script">
<link rel="preload" href="/carefree-learn-doc/main.dd328fb3.js" as="script">
<link rel="preload" href="/carefree-learn-doc/1.af23113f.js" as="script">
<link rel="preload" href="/carefree-learn-doc/38.2eb5bb76.js" as="script">
<link rel="preload" href="/carefree-learn-doc/42.87c72e53.js" as="script">
<link rel="preload" href="/carefree-learn-doc/935f2afb.18248dcc.js" as="script">
<link rel="preload" href="/carefree-learn-doc/37.10722e50.js" as="script">
<link rel="preload" href="/carefree-learn-doc/52fcee04.97421257.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/carefree-learn-doc/"><strong class="navbar__title">carefree-learn</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/carefree-learn-doc/docs/">Docs</a><a class="navbar__item navbar__link" href="/carefree-learn-doc/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">‚åò</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/carefree-learn-doc/"><strong class="navbar__title">carefree-learn</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/carefree-learn-doc/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/carefree-learn-doc/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">carefree-learn</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/design-principles">Design Principles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/optimizations">Optimizations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/getting-started/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/getting-started/quick-start">Quick Start</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/getting-started/configurations">Configurations</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Examples</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/carefree-learn-doc/docs/examples/Iris">Iris</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/carefree-learn-doc/docs/examples/Titanic">Titanic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/carefree-learn-doc/docs/examples/MNIST">MNIST</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">User Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/user-guides/general">General</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/user-guides/computer-vision">Computer Vision üñºÔ∏è</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/user-guides/machine-learning">Machine Learning üìà</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Developer Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/developer-guides/general-customization">General</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/developer-guides/computer-vision-customization">Computer Vision üñºÔ∏è</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/developer-guides/machine-learning-customization">Machine Learning üìà</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/developer-guides/contributing">Contributing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/developer-guides/code-of-conduct">Code of Conduct</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/about/release-notes">Release Notes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/carefree-learn-doc/docs/about/license">License</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Iris</h1></header><div class="markdown"><table><thead><tr><th align="center">Python source code</th><th align="center">Jupyter Notebook</th><th align="center">Task</th></tr></thead><tbody><tr><td align="center"><a href="https://github.com/carefree0910/carefree-learn/blob/dev/examples/ml/iris/run_iris.py" target="_blank" rel="noopener noreferrer">iris.py</a></td><td align="center"><a href="https://nbviewer.org/github/carefree0910/carefree-learn/blob/dev/examples/ml/iris/iris.ipynb" target="_blank" rel="noopener noreferrer">iris.ipynb</a></td><td align="center">Machine Learning üìà</td></tr></tbody></table><p>Here are some of the information provided by the official website:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">This is perhaps the best known database to be found in the pattern recognition literature.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">The data set contains 3 classes of 50 instances each, where each class refers to a type of iris plant.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Predicted attribute: class of iris plant.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>And here&#x27;s the pandas-view of the raw data:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">      f0   f1   f2   f3           label</span></div><div class="token-line" style="color:#393A34"><span class="token plain">0    5.1  3.5  1.4  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">1    4.9  3.0  1.4  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">2    4.7  3.2  1.3  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">3    4.6  3.1  1.5  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">4    5.0  3.6  1.4  0.2     Iris-setosa</span></div><div class="token-line" style="color:#393A34"><span class="token plain">..   ...  ...  ...  ...             ...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">145  6.7  3.0  5.2  2.3  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain">146  6.3  2.5  5.0  1.9  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain">147  6.5  3.0  5.2  2.0  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain">148  6.2  3.4  5.4  2.3  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain">149  5.9  3.0  5.1  1.8  Iris-virginica</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">[150 rows x 5 columns]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><ul><li>You can download the raw data (<code>iris.data</code>) with <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data" target="_blank" rel="noopener noreferrer">this link</a>.</li><li>We didn&#x27;t use pandas in our code, but it is convenient to visualize some data with it though ü§£</li></ul></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># preparations</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> torch</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pickle</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cflearn</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">seed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">142857</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">manual_seed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">142857</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="basic-usages"></a>Basic Usages<a aria-hidden="true" class="hash-link" href="#basic-usages" title="Direct link to heading">#</a></h2><p>Traditionally, we need to process the raw data before we feed them into our machine learning models (e.g. encode the label column, which is a string column, into an ordinal column). In <code>carefree-learn</code>, however, we can train neural networks directly on files without worrying about the rest:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_ml</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> carefree</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>What&#x27;s going under the hood is that <code>carefree-learn</code> will try to parse the <code>iris.data</code> automatically (with the help of <a href="https://github.com/carefree0910/carefree-data" target="_blank" rel="noopener noreferrer">carefree-data</a>), split the data into training set and validation set, with which we&#x27;ll train a fully connected neural network (fcnn).</p><p>We can further inspect the processed data if we want to know how <code>carefree-learn</code> actually parsed the input data:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cf_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">raw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cf_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">raw</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cf_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cf_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">[5.1 3.5 1.4 0.2]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">[&#x27;Iris-setosa&#x27;]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">[-0.9006812  1.0320569 -1.3412726 -1.3129768]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">[2]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>It shows that the raw data is carefully normalized into numerical data that neural networks can accept. What&#x27;s more, by saying <em>normalized</em>, it means that the input features will be automatically normalized to <code>mean=0.0</code> and <code>std=1.0</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">ata </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span></div><div class="token-line" style="color:#393A34"><span class="token plain">x_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">train_cf_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">x_valid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_valid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">valid_cf_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">stacked </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">x_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x_valid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stacked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stacked</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">std</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">[-5.5631002e-09 -3.2588841e-07 -1.5576680e-07 -5.7220458e-08]</span></div><div class="token-line" style="color:#393A34"><span class="token plain">[0.9999999 1.0000001 1.0000002 0.9999999]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The results shown above means we first normalized the data before we actually split it into train &amp; validation set.</p></div></div><p>After training on files, <code>carefree-learn</code> can predict &amp; evaluate on files directly as well. We&#x27;ll handle the data parsing and normalization for you automatically:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># instantiate an `MLInferenceData` instance</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">idata </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MLInferenceData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># `contains_labels` is set to True because `iris.data` itself contains labels</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">predictions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">idata</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> contains_labels</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># It is OK to simply call `m.predict(&quot;iris.data&quot;)` because `contains_labels` is True by default</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">predictions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">idata</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># evaluations could be achieved easily with cflearn.evaluate</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">idata</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metrics</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;acc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;auc&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipelines</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        metrics         |                       acc                        |                       auc                        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          fcnn          |    0.926667    |    0.000000    |    0.926667    |    0.994800    |    0.000000    |    0.994800    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="benchmarking"></a>Benchmarking<a aria-hidden="true" class="hash-link" href="#benchmarking" title="Direct link to heading">#</a></h2><p>As we know, neural networks are trained with <strong><em>stochastic</em></strong> gradient descent (and its variants), which will introduce some randomness to the final result, even if we are training on the same dataset. In this case, we need to repeat the same task several times in order to obtain the bias &amp; variance of our neural networks.</p><p>Fortunately, <code>carefree-learn</code> introduced <code>repeat_ml</code> API, which can achieve this goal easily with only a few lines of code:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># With num_repeat=3 specified, we&#x27;ll train 3 models on `iris.data`.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">repeat_ml</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> carefree</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_repeat</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">idata</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metrics</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;acc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;auc&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipelines</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipelines</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        metrics         |                       acc                        |                       auc                        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          fcnn          |    0.902222    |    0.019116    |    0.883106    |    0.985778    |    0.004722    |    0.981055    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>We can also compare the performances across different models:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># With models=[&quot;linear&quot;, &quot;fcnn&quot;], we&#x27;ll train both linear models and fcnn models.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">models </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;linear&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fcnn&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">repeat_ml</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> carefree</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> models</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">models</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_repeat</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">idata</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metrics</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;acc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;auc&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipelines</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipelines</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        metrics         |                       acc                        |                       auc                        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          fcnn          | -- 0.915556 -- | -- 0.027933 -- | -- 0.887623 -- | -- 0.985467 -- | -- 0.004121 -- | -- 0.981345 -- |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|         linear         |    0.620000    |    0.176970    |    0.443030    |    0.733778    |    0.148427    |    0.585351    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>It is worth mentioning that <code>carefree-learn</code> supports Distributed Training, which means when we need to perform large scale benchmarking (e.g. train 100 models), we could accelerate the process through multiprocessing:</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>In <code>carefree-learn</code>, Distributed Training in Machine Learning tasks sometimes doesn&#x27;t mean training your model on multiple GPUs or multiple machines. Instead, it may mean training multiple models at the same time.</p></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># With num_jobs=2, we will launch 2 processes to run the tasks in a distributed way.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">repeat_ml</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;iris.data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> carefree</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_repeat</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_jobs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>On iris dataset, however, launching distributed training will actually hurt the speed because iris dataset only contains 150 samples, so the relative overhead brought by distributed training will be too large.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="advanced-benchmarking"></a>Advanced Benchmarking<a aria-hidden="true" class="hash-link" href="#advanced-benchmarking" title="Direct link to heading">#</a></h2><p>But this is not enough, because we want to know whether other models (e.g. scikit-learn models) could achieve a better performance than <code>carefree-learn</code> models. In this case, we can perform an advanced benchmarking with the <code>Experiment</code> helper class.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">experiment </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dist</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Experiment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">data_folder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dump_data_bundle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x_valid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_valid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add carefree-learn tasks</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;fcnn&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_folder</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data_folder</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;linear&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_folder</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data_folder</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add scikit-learn tasks</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">run_command </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;python run_sklearn.py&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">common_kwargs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;run_command&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> run_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;data_folder&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data_folder</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;decision_tree&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">common_kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;random_forest&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">common_kwargs</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Notice that we specified <code>run_command=&quot;python run_sklearn.py&quot;</code> for scikit-learn tasks, which means <code>Experiment</code> will try to execute this command in the current working directory for training scikit-learn models. The good news is that we do not need to speciy any command line arguments, because <code>Experiment</code> will handle those for us.</p><p>Here is basically what a <code>run_sklearn.py</code> should look like (<a href="https://github.com/carefree0910/carefree-learn/blob/dev/examples/ml/iris/run_sklearn.py" target="_blank" rel="noopener noreferrer">source code</a>):</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pickle</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tree </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> DecisionTreeClassifier</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ensemble </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> RandomForestClassifier</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dist</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">runs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_info</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    info </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    kwargs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kwargs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># data</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    data_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_list</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data_list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># model</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kwargs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;model&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> model </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;decision_tree&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        base </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> DecisionTreeClassifier</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> model </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;random_forest&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        base </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> RandomForestClassifier</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">raise</span><span class="token plain"> NotImplementedError</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    sk_model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># train &amp; save</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    sk_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ravel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workplace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sk_model.pkl&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;wb&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        pickle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dump</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sk_model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>With <code>run_sklearn.py</code> defined, we could run those tasks with one line of code:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> experiment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run_tasks</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>After finished running with this, we should be able to see the following file structure in the current working directory:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">|--- __experiment__</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- __data__</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- x.npy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- y.npy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- x_cv.npy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- y_cv.npy</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- fcnn/0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- _logs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- __meta__.json</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- cflearn^_^fcnn^_^0000.zip</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- linear/0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- ...</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- decision_tree/0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- __meta__.json</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- sk_model.pkl</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   |--- random_forest/0</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      |-- ...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>As we expected, <code>carefree-learn</code> models are saved into <code>.zip</code> files, while scikit-learn models are saved into <code>sk_model.pkl</code> files. Since these models are not yet loaded, we should manually load them into our environment:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">pipelines </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">sk_patterns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> workplace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workplace_key </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">zip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workplaces</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workplace_keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> workplace_key</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> model </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;decision_tree&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;random_forest&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        pipelines</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">task_loader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workplace</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        model_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workplace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sk_model.pkl&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rb&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pickle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># In `carefree-learn`, we treat labels as column vectors.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># So we need to reshape the outputs from the scikit-learn models.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_predict </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> d</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sk_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x_train</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_predict_prob </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> d</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sk_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict_proba</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x_train</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_pattern </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModelPattern</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                predict_method</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sk_predict</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                predict_prob_method</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sk_predict_prob</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            sk_patterns</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sk_pattern</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>After which we can finally perform benchmarking on these models:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-python codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">idata </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MLInferenceData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x_valid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_valid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">cflearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">idata</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metrics</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;acc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;auc&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pipelines</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">pipelines</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> other_patterns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sk_patterns</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Which yields</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-text codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        metrics         |                       acc                        |                       auc                        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                        |      mean      |      std       |     score      |      mean      |      std       |     score      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|     decision_tree      |    0.920000    | -- 0.000000 -- |    0.920000    |    0.995199    | -- 0.000000 -- |    0.995199    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|          fcnn          | -- 0.959999 -- | -- 0.000000 -- | -- 0.959999 -- | -- 0.997866 -- | -- 0.000000 -- | -- 0.997866 -- |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|         linear         |    0.693333    | -- 0.000000 -- |    0.693333    |    0.940533    | -- 0.000000 -- |    0.940533    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------------------------------------------------------------------------</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|     random_forest      |    0.920000    | -- 0.000000 -- |    0.920000    |    0.995199    | -- 0.000000 -- |    0.995199    |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">================================================================================================================================</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="conclusion"></a>Conclusion<a aria-hidden="true" class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><p>Contained in this article is just a subset of the features that <code>carefree-learn</code> offers, but we&#x27;ve already walked through many basic &amp; common steps we&#x27;ll encounter in real life machine learning tasks.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-10-23T13:31:46.000Z" class="docLastUpdatedAt_217_">10/23/2021</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/carefree-learn-doc/docs/getting-started/configurations"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Configurations</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/carefree-learn-doc/docs/examples/Titanic"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Titanic ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#basic-usages" class="table-of-contents__link">Basic Usages</a></li><li><a href="#benchmarking" class="table-of-contents__link">Benchmarking</a></li><li><a href="#advanced-benchmarking" class="table-of-contents__link">Advanced Benchmarking</a></li><li><a href="#conclusion" class="table-of-contents__link">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/docs/getting-started/installation/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/docs/getting-started/quick-start">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/docs/design-principles/">Design Principles</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/carefree0910" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/carefree-learn-doc/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/carefree0910/carefree-learn" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright ¬© 2021 carefree-learn, carefree0910. Built with Docusaurus.</div></div></div></footer></div>
<script src="/carefree-learn-doc/styles.dfcd65fb.js"></script>
<script src="/carefree-learn-doc/runtime~main.87def90a.js"></script>
<script src="/carefree-learn-doc/main.dd328fb3.js"></script>
<script src="/carefree-learn-doc/1.af23113f.js"></script>
<script src="/carefree-learn-doc/38.2eb5bb76.js"></script>
<script src="/carefree-learn-doc/42.87c72e53.js"></script>
<script src="/carefree-learn-doc/935f2afb.18248dcc.js"></script>
<script src="/carefree-learn-doc/37.10722e50.js"></script>
<script src="/carefree-learn-doc/52fcee04.97421257.js"></script>
</body>
</html>